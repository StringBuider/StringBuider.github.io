<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ´¾å‘æ›´æ–° | å°å¼ çš„å…±äº«æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="ğŸ¤”ä½ æœ‰ä»€ä¹ˆæƒ³è¯´ï¼Ÿå†™è¿›æ¥å§ï¼ğŸ˜">
    
    <link rel="preload" href="./assets/css/0.styles.a246c231.css" as="style"><link rel="preload" href="./assets/js/app.c50cae2e.js" as="script"><link rel="preload" href="./assets/js/4.08095b6d.js" as="script"><link rel="preload" href="./assets/js/69.fffc95ef.js" as="script"><link rel="prefetch" href="./assets/js/10.ed3e9f33.js"><link rel="prefetch" href="./assets/js/11.6495f8ce.js"><link rel="prefetch" href="./assets/js/12.e15e40c1.js"><link rel="prefetch" href="./assets/js/13.33a2b3c3.js"><link rel="prefetch" href="./assets/js/14.5d605ae8.js"><link rel="prefetch" href="./assets/js/15.b5e3a30f.js"><link rel="prefetch" href="./assets/js/16.32bee43d.js"><link rel="prefetch" href="./assets/js/17.67f7f069.js"><link rel="prefetch" href="./assets/js/18.af04d610.js"><link rel="prefetch" href="./assets/js/19.730c3139.js"><link rel="prefetch" href="./assets/js/2.7fc48c46.js"><link rel="prefetch" href="./assets/js/20.1c4fbbf9.js"><link rel="prefetch" href="./assets/js/21.67119724.js"><link rel="prefetch" href="./assets/js/22.c2076f14.js"><link rel="prefetch" href="./assets/js/23.f25b155f.js"><link rel="prefetch" href="./assets/js/24.c8791672.js"><link rel="prefetch" href="./assets/js/25.af22f7f1.js"><link rel="prefetch" href="./assets/js/26.777a42b7.js"><link rel="prefetch" href="./assets/js/27.25c6658f.js"><link rel="prefetch" href="./assets/js/28.4c66a1fb.js"><link rel="prefetch" href="./assets/js/29.45d218cd.js"><link rel="prefetch" href="./assets/js/3.fb9770df.js"><link rel="prefetch" href="./assets/js/30.2cfa5f3d.js"><link rel="prefetch" href="./assets/js/31.9a7819c6.js"><link rel="prefetch" href="./assets/js/32.6b80cecb.js"><link rel="prefetch" href="./assets/js/33.e00e1922.js"><link rel="prefetch" href="./assets/js/34.445fb4ff.js"><link rel="prefetch" href="./assets/js/35.2f86d553.js"><link rel="prefetch" href="./assets/js/36.7e8dc342.js"><link rel="prefetch" href="./assets/js/37.827964ca.js"><link rel="prefetch" href="./assets/js/38.306618b3.js"><link rel="prefetch" href="./assets/js/39.96d345b4.js"><link rel="prefetch" href="./assets/js/40.5327dcb2.js"><link rel="prefetch" href="./assets/js/41.29160afa.js"><link rel="prefetch" href="./assets/js/42.3ec42885.js"><link rel="prefetch" href="./assets/js/43.db7bc261.js"><link rel="prefetch" href="./assets/js/44.60eae751.js"><link rel="prefetch" href="./assets/js/45.15437d11.js"><link rel="prefetch" href="./assets/js/46.55a5744d.js"><link rel="prefetch" href="./assets/js/47.e8e54de1.js"><link rel="prefetch" href="./assets/js/48.97e52f5e.js"><link rel="prefetch" href="./assets/js/49.c58d43a4.js"><link rel="prefetch" href="./assets/js/5.4c884eba.js"><link rel="prefetch" href="./assets/js/50.a93fcdb0.js"><link rel="prefetch" href="./assets/js/51.c43da0f8.js"><link rel="prefetch" href="./assets/js/52.e0cc02e1.js"><link rel="prefetch" href="./assets/js/53.95f0f53a.js"><link rel="prefetch" href="./assets/js/54.c4c47eaf.js"><link rel="prefetch" href="./assets/js/55.b37c9037.js"><link rel="prefetch" href="./assets/js/56.3d8ed2b4.js"><link rel="prefetch" href="./assets/js/57.bd65c07b.js"><link rel="prefetch" href="./assets/js/58.134b9e82.js"><link rel="prefetch" href="./assets/js/59.24c871f7.js"><link rel="prefetch" href="./assets/js/6.4e374fac.js"><link rel="prefetch" href="./assets/js/60.b75523ad.js"><link rel="prefetch" href="./assets/js/61.484be178.js"><link rel="prefetch" href="./assets/js/62.180c4d5d.js"><link rel="prefetch" href="./assets/js/63.c4c8b737.js"><link rel="prefetch" href="./assets/js/64.3921bee2.js"><link rel="prefetch" href="./assets/js/65.8c31bc75.js"><link rel="prefetch" href="./assets/js/66.a5410547.js"><link rel="prefetch" href="./assets/js/67.32e09623.js"><link rel="prefetch" href="./assets/js/68.4d59d330.js"><link rel="prefetch" href="./assets/js/7.ef54b1c1.js"><link rel="prefetch" href="./assets/js/70.72980d01.js"><link rel="prefetch" href="./assets/js/71.fbafa4c6.js"><link rel="prefetch" href="./assets/js/72.59e84ead.js"><link rel="prefetch" href="./assets/js/73.62c6073a.js"><link rel="prefetch" href="./assets/js/74.098849aa.js"><link rel="prefetch" href="./assets/js/75.c4126dcd.js"><link rel="prefetch" href="./assets/js/76.288ce637.js"><link rel="prefetch" href="./assets/js/77.405cc8e4.js"><link rel="prefetch" href="./assets/js/78.f092ec42.js"><link rel="prefetch" href="./assets/js/79.5965beb6.js"><link rel="prefetch" href="./assets/js/8.1e8a08c7.js"><link rel="prefetch" href="./assets/js/80.b06d3623.js"><link rel="prefetch" href="./assets/js/81.7e1c12fd.js"><link rel="prefetch" href="./assets/js/82.23093c7e.js"><link rel="prefetch" href="./assets/js/9.07409efc.js">
    <link rel="stylesheet" href="./assets/css/0.styles.a246c231.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">å°å¼ çš„å…±äº«æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŒ‡å—" class="dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow down"></span></button> <button type="button" aria-label="æŒ‡å—" class="mobile-dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./guide/getting-started.html" class="nav-link">
  å‚ä¸å†™ä½œ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends.html" class="nav-link">
  å¾®å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends-faq.html" class="nav-link">
  å¾®å‰ç«¯FAQ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/git-flow.html" class="nav-link">
  å·¥ä½œæµ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è§„èŒƒ" class="dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="è§„èŒƒ" class="mobile-dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-route.html" class="nav-link">
  å¾®å‰ç«¯-è·¯ç”±è§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-version-control.html" class="nav-link">
  å¾®å‰ç«¯-ç‰ˆæœ¬ç®¡ç†
</a></li><li class="dropdown-item"><!----> <a href="/./standard/typescript.html" class="nav-link">
  TypeScriptè§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/code-version-control.html" class="nav-link">
  ä»£ç åˆ†æ”¯ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tips" class="dropdown-title"><span class="title">tips</span> <span class="arrow down"></span></button> <button type="button" aria-label="tips" class="mobile-dropdown-title"><span class="title">tips</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./tips/url-mode.html" class="nav-link">
  urlæ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ’ä»¶" class="dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ’ä»¶" class="mobile-dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./plugins/plugin.html" class="nav-link">
  æ’ä»¶åˆ†äº«
</a></li></ul></div></div><div class="nav-item"><a href="/./vue2/prepare/" class="nav-link">
  vue2.x
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue3.x" class="dropdown-title"><span class="title">vue3.x</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue3.x" class="mobile-dropdown-title"><span class="title">vue3.x</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./vue3/essence-of-comp.html" class="nav-link">
  ç»„ä»¶çš„æœ¬è´¨
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/vnode.html" class="nav-link">
  æŠŠVNodeè§£å‰–ä¸€ä¸‹
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/h.html" class="nav-link">
  è¾…åŠ©åˆ›å»º VNode çš„ h å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/observer.html" class="nav-link">
  å“åº”å¼åŸç†
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹æŒ‚è½½
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-patch.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹patch
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-diff.html" class="nav-link">
  æ¸²æŸ“å™¨çš„æ ¸å¿ƒ Diff ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-advanced.html" class="nav-link">
  è‡ªå®šä¹‰æ¸²æŸ“å™¨
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="mobile-dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./basic/basic.html" class="nav-link">
  å…«è‚¡æ–‡
</a></li><li class="dropdown-item"><!----> <a href="/./basic/arithmetic.html" class="nav-link">
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./basic/desinmode.html" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•ç»éªŒ" class="dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="é¢è¯•ç»éªŒ" class="mobile-dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./interview/interview.html" class="nav-link">
  é¢è¯•ç»éªŒ
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŒ‡å—" class="dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow down"></span></button> <button type="button" aria-label="æŒ‡å—" class="mobile-dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./guide/getting-started.html" class="nav-link">
  å‚ä¸å†™ä½œ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends.html" class="nav-link">
  å¾®å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends-faq.html" class="nav-link">
  å¾®å‰ç«¯FAQ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/git-flow.html" class="nav-link">
  å·¥ä½œæµ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è§„èŒƒ" class="dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="è§„èŒƒ" class="mobile-dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-route.html" class="nav-link">
  å¾®å‰ç«¯-è·¯ç”±è§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-version-control.html" class="nav-link">
  å¾®å‰ç«¯-ç‰ˆæœ¬ç®¡ç†
</a></li><li class="dropdown-item"><!----> <a href="/./standard/typescript.html" class="nav-link">
  TypeScriptè§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/code-version-control.html" class="nav-link">
  ä»£ç åˆ†æ”¯ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tips" class="dropdown-title"><span class="title">tips</span> <span class="arrow down"></span></button> <button type="button" aria-label="tips" class="mobile-dropdown-title"><span class="title">tips</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./tips/url-mode.html" class="nav-link">
  urlæ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ’ä»¶" class="dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ’ä»¶" class="mobile-dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./plugins/plugin.html" class="nav-link">
  æ’ä»¶åˆ†äº«
</a></li></ul></div></div><div class="nav-item"><a href="/./vue2/prepare/" class="nav-link">
  vue2.x
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue3.x" class="dropdown-title"><span class="title">vue3.x</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue3.x" class="mobile-dropdown-title"><span class="title">vue3.x</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./vue3/essence-of-comp.html" class="nav-link">
  ç»„ä»¶çš„æœ¬è´¨
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/vnode.html" class="nav-link">
  æŠŠVNodeè§£å‰–ä¸€ä¸‹
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/h.html" class="nav-link">
  è¾…åŠ©åˆ›å»º VNode çš„ h å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/observer.html" class="nav-link">
  å“åº”å¼åŸç†
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹æŒ‚è½½
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-patch.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹patch
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-diff.html" class="nav-link">
  æ¸²æŸ“å™¨çš„æ ¸å¿ƒ Diff ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-advanced.html" class="nav-link">
  è‡ªå®šä¹‰æ¸²æŸ“å™¨
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="mobile-dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./basic/basic.html" class="nav-link">
  å…«è‚¡æ–‡
</a></li><li class="dropdown-item"><!----> <a href="/./basic/arithmetic.html" class="nav-link">
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./basic/desinmode.html" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•ç»éªŒ" class="dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="é¢è¯•ç»éªŒ" class="mobile-dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./interview/interview.html" class="nav-link">
  é¢è¯•ç»éªŒ
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å‡†å¤‡å·¥ä½œ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/prepare/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/prepare/flow.html" class="sidebar-link">è®¤è¯† Flow</a></li><li><a href="/./vue2/prepare/directory.html" class="sidebar-link">Vue.js æºç ç›®å½•è®¾è®¡</a></li><li><a href="/./vue2/prepare/build.html" class="sidebar-link">Vue.js æºç æ„å»º</a></li><li><a href="/./vue2/prepare/entrance.html" class="sidebar-link">ä»å…¥å£å¼€å§‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ•°æ®é©±åŠ¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/data-driven/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/data-driven/new-vue.html" class="sidebar-link">new Vue å‘ç”Ÿäº†ä»€ä¹ˆ</a></li><li><a href="/./vue2/data-driven/mounted.html" class="sidebar-link">Vue å®ä¾‹æŒ‚è½½çš„å®ç°</a></li><li><a href="/./vue2/data-driven/render.html" class="sidebar-link">render</a></li><li><a href="/./vue2/data-driven/virtual-dom.html" class="sidebar-link">Virtual DOM</a></li><li><a href="/./vue2/data-driven/create-element.html" class="sidebar-link">createElement</a></li><li><a href="/./vue2/data-driven/update.html" class="sidebar-link">update</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç»„ä»¶åŒ–</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/components/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/components/create-component.html" class="sidebar-link">createComponent</a></li><li><a href="/./vue2/components/patch.html" class="sidebar-link">patch</a></li><li><a href="/./vue2/components/merge-option.html" class="sidebar-link">åˆå¹¶é…ç½®</a></li><li><a href="/./vue2/components/lifecycle.html" class="sidebar-link">ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="/./vue2/components/component-register.html" class="sidebar-link">ç»„ä»¶æ³¨å†Œ</a></li><li><a href="/./vue2/components/async-component.html" class="sidebar-link">å¼‚æ­¥ç»„ä»¶</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>æ·±å…¥å“åº”å¼åŸç†</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/reactive/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/reactive/reactive-object.html" class="sidebar-link">å“åº”å¼å¯¹è±¡</a></li><li><a href="/./vue2/reactive/getters.html" class="sidebar-link">ä¾èµ–æ”¶é›†</a></li><li><a href="/./vue2/reactive/setters.html" aria-current="page" class="active sidebar-link">æ´¾å‘æ›´æ–°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./vue2/reactive/setters.html#è¿‡ç¨‹åˆ†æ" class="sidebar-link">è¿‡ç¨‹åˆ†æ</a></li><li class="sidebar-sub-header"><a href="/./vue2/reactive/setters.html#æ€»ç»“" class="sidebar-link">æ€»ç»“</a></li></ul></li><li><a href="/./vue2/reactive/next-tick.html" class="sidebar-link">nextTick</a></li><li><a href="/./vue2/reactive/questions.html" class="sidebar-link">æ£€æµ‹å˜åŒ–çš„æ³¨æ„äº‹é¡¹</a></li><li><a href="/./vue2/reactive/computed-watcher.html" class="sidebar-link">è®¡ç®—å±æ€§ VS ä¾¦å¬å±æ€§</a></li><li><a href="/./vue2/reactive/component-update.html" class="sidebar-link">ç»„ä»¶æ›´æ–°</a></li><li><a href="/./vue2/reactive/props.html" class="sidebar-link">Props (v2.6.11)</a></li><li><a href="/./vue2/reactive/summary.html" class="sidebar-link">åŸç†å›¾</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ç¼–è¯‘</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/compile/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/compile/entrance.html" class="sidebar-link">ç¼–è¯‘å…¥å£</a></li><li><a href="/./vue2/compile/parse.html" class="sidebar-link">parse</a></li><li><a href="/./vue2/compile/optimize.html" class="sidebar-link">optimize</a></li><li><a href="/./vue2/compile/codegen.html" class="sidebar-link">codegen</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>æ‰©å±•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/extend/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/extend/event.html" class="sidebar-link">event</a></li><li><a href="/./vue2/extend/v-model.html" class="sidebar-link">v-model</a></li><li><a href="/./vue2/extend/slot.html" class="sidebar-link">slot</a></li><li><a href="/./vue2/extend/keep-alive.html" class="sidebar-link">keep-alive</a></li><li><a href="/./vue2/extend/tansition.html" class="sidebar-link">transition</a></li><li><a href="/./vue2/extend/tansition-group.html" class="sidebar-link">transition-group</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vue Router</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/vue-router/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/vue-router/install.html" class="sidebar-link">è·¯ç”±æ³¨å†Œ</a></li><li><a href="/./vue2/vue-router/router.html" class="sidebar-link">VueRouter å¯¹è±¡</a></li><li><a href="/./vue2/vue-router/matcher.html" class="sidebar-link">matcher</a></li><li><a href="/./vue2/vue-router/transition-to.html" class="sidebar-link">è·¯å¾„åˆ‡æ¢</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Vuex</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue2/vuex/" class="sidebar-link">Introduction</a></li><li><a href="/./vue2/vuex/init.html" class="sidebar-link">Vuex åˆå§‹åŒ–</a></li><li><a href="/./vue2/vuex/api.html" class="sidebar-link">API</a></li><li><a href="/./vue2/vuex/plugin.html" class="sidebar-link">æ’ä»¶</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="æ´¾å‘æ›´æ–°"><a href="#æ´¾å‘æ›´æ–°" class="header-anchor">#</a> æ´¾å‘æ›´æ–°</h1> <p>é€šè¿‡ä¸Šä¸€èŠ‚åˆ†ææˆ‘ä»¬äº†è§£äº†å“åº”å¼æ•°æ®ä¾èµ–æ”¶é›†è¿‡ç¨‹ï¼Œæ”¶é›†çš„ç›®çš„å°±æ˜¯ä¸ºäº†å½“æˆ‘ä»¬ä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥å¯¹ç›¸å…³çš„ä¾èµ–æ´¾å‘æ›´æ–°ï¼Œé‚£ä¹ˆè¿™ä¸€èŠ‚æˆ‘ä»¬æ¥è¯¦ç»†åˆ†æè¿™ä¸ªè¿‡ç¨‹ã€‚</p> <p>æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹ setter éƒ¨åˆ†çš„é€»è¾‘ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * Define a reactive property on an Object.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">defineReactive</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">obj</span><span class="token operator">:</span> Object<span class="token punctuation">,</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">val</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  customSetter<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span>Function<span class="token punctuation">,</span>
  shallow<span class="token operator">?</span><span class="token operator">:</span> boolean</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> property <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>property <span class="token operator">&amp;&amp;</span> property<span class="token punctuation">.</span>configurable <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// cater for pre-defined getter/setters</span>
  <span class="token keyword">const</span> getter <span class="token operator">=</span> property <span class="token operator">&amp;&amp;</span> property<span class="token punctuation">.</span>get
  <span class="token keyword">const</span> setter <span class="token operator">=</span> property <span class="token operator">&amp;&amp;</span> property<span class="token punctuation">.</span>set
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>getter <span class="token operator">||</span> setter<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> arguments<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    val <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> childOb <span class="token operator">=</span> <span class="token operator">!</span>shallow <span class="token operator">&amp;&amp;</span> <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveSetter</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val
      <span class="token comment">/* eslint-disable no-self-compare */</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">===</span> value <span class="token operator">||</span> <span class="token punctuation">(</span>newVal <span class="token operator">!==</span> newVal <span class="token operator">&amp;&amp;</span> value <span class="token operator">!==</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token comment">/* eslint-enable no-self-compare */</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> customSetter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">customSetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>setter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        val <span class="token operator">=</span> newVal
      <span class="token punctuation">}</span>
      childOb <span class="token operator">=</span> <span class="token operator">!</span>shallow <span class="token operator">&amp;&amp;</span> <span class="token function">observe</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span>
      dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>setter çš„é€»è¾‘æœ‰ 2 ä¸ªå…³é”®çš„ç‚¹ï¼Œä¸€ä¸ªæ˜¯ <code>childOb = !shallow &amp;&amp; observe(newVal)</code>ï¼Œå¦‚æœ <code>shallow</code> ä¸º false çš„æƒ…å†µï¼Œä¼šå¯¹æ–°è®¾ç½®çš„å€¼å˜æˆä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼›å¦ä¸€ä¸ªæ˜¯ <code>dep.notify()</code>ï¼Œé€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…ï¼Œè¿™æ˜¯æœ¬èŠ‚çš„å…³é”®ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šå¸¦å¤§å®¶å®Œæ•´çš„åˆ†ææ•´ä¸ªæ´¾å‘æ›´æ–°çš„è¿‡ç¨‹ã€‚</p> <h2 id="è¿‡ç¨‹åˆ†æ"><a href="#è¿‡ç¨‹åˆ†æ" class="header-anchor">#</a> è¿‡ç¨‹åˆ†æ</h2> <p>å½“æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­å¯¹å“åº”çš„æ•°æ®åšäº†ä¿®æ”¹ï¼Œå°±ä¼šè§¦å‘ setter çš„é€»è¾‘ï¼Œæœ€åè°ƒç”¨ <code>dep.notify()</code> æ–¹æ³•ï¼Œ
å®ƒæ˜¯ <code>Dep</code> çš„ä¸€ä¸ªå®ä¾‹æ–¹æ³•ï¼Œå®šä¹‰åœ¨ <code>src/core/observer/dep.js</code> ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Dep</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token function">notify</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// stabilize the subscriber list first</span>
    <span class="token keyword">const</span> subs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> subs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      subs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œçš„é€»è¾‘éå¸¸ç®€å•ï¼Œéå†æ‰€æœ‰çš„ <code>subs</code>ï¼Œä¹Ÿå°±æ˜¯ <code>Watcher</code> çš„å®ä¾‹æ•°ç»„ï¼Œç„¶åè°ƒç”¨æ¯ä¸€ä¸ª <code>watcher</code> çš„ <code>update</code> æ–¹æ³•ï¼Œå®ƒçš„å®šä¹‰åœ¨ <code>src/core/observer/watcher.js</code> ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token function">update</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/* istanbul ignore else */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// A computed property watcher has two modes: lazy and activated.</span>
      <span class="token comment">// It initializes as lazy by default, and only becomes activated when</span>
      <span class="token comment">// it is depended on by at least one subscriber, which is typically</span>
      <span class="token comment">// another computed property or a component's render function.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">.</span>subs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// In lazy mode, we don't want to perform computations until necessary,</span>
        <span class="token comment">// so we simply mark the watcher as dirty. The actual computation is</span>
        <span class="token comment">// performed just-in-time in this.evaluate() when the computed property</span>
        <span class="token comment">// is accessed.</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// In activated mode, we want to proactively perform the computation</span>
        <span class="token comment">// but only notify our subscribers when the value has indeed changed.</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAndInvoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>  
</code></pre></div><p>è¿™é‡Œå¯¹äº <code>Watcher</code> çš„ä¸åŒçŠ¶æ€ï¼Œä¼šæ‰§è¡Œä¸åŒçš„é€»è¾‘ï¼Œ<code>computed</code> å’Œ <code>sync</code> ç­‰çŠ¶æ€çš„åˆ†ææˆ‘ä¼šä¹‹åæŠ½ä¸€å°èŠ‚è¯¦ç»†ä»‹ç»ï¼Œåœ¨ä¸€èˆ¬ç»„ä»¶æ•°æ®æ›´æ–°çš„åœºæ™¯ï¼Œä¼šèµ°åˆ°æœ€åä¸€ä¸ª <code>queueWatcher(this)</code> çš„é€»è¾‘ï¼Œ<code>queueWatcher</code> çš„å®šä¹‰åœ¨ <code>src/core/observer/scheduler.js</code> ä¸­ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token literal-property property">queue</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>Watcher<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> <span class="token literal-property property">has</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> waiting <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> flushing <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token comment">/**
 * Push a watcher into the watcher queue.
 * Jobs with duplicate IDs will be skipped unless it's
 * pushed when the queue is being flushed.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">queueWatcher</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">watcher</span><span class="token operator">:</span> Watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id
  <span class="token keyword">if</span> <span class="token punctuation">(</span>has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flushing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// if already flushing, splice the watcher based on its id</span>
      <span class="token comment">// if already past its id, it will be run next immediately.</span>
      <span class="token keyword">let</span> i <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> index <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&gt;</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        i<span class="token operator">--</span>
      <span class="token punctuation">}</span>
      queue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> watcher<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// queue the flush</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>waiting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      waiting <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token function">nextTick</span><span class="token punctuation">(</span>flushSchedulerQueue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªé˜Ÿåˆ—çš„æ¦‚å¿µï¼Œè¿™ä¹Ÿæ˜¯ Vue åœ¨åšæ´¾å‘æ›´æ–°çš„æ—¶å€™çš„ä¸€ä¸ªä¼˜åŒ–çš„ç‚¹ï¼Œå®ƒå¹¶ä¸ä¼šæ¯æ¬¡æ•°æ®æ”¹å˜éƒ½è§¦å‘ <code>watcher</code> çš„å›è°ƒï¼Œè€Œæ˜¯æŠŠè¿™äº› <code>watcher</code> å…ˆæ·»åŠ åˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œç„¶ååœ¨ <code>nextTick</code> åæ‰§è¡Œ <code>flushSchedulerQueue</code>ã€‚</p> <p>è¿™é‡Œæœ‰å‡ ä¸ªç»†èŠ‚è¦æ³¨æ„ä¸€ä¸‹ï¼Œé¦–å…ˆç”¨ <code>has</code> å¯¹è±¡ä¿è¯åŒä¸€ä¸ª <code>Watcher</code> åªæ·»åŠ ä¸€æ¬¡ï¼›æ¥ç€å¯¹ <code>flushing</code> çš„åˆ¤æ–­ï¼Œelse éƒ¨åˆ†çš„é€»è¾‘ç¨åæˆ‘ä¼šè®²ï¼›æœ€åé€šè¿‡ <code>waiting</code> ä¿è¯å¯¹ <code>nextTick(flushSchedulerQueue)</code> çš„è°ƒç”¨é€»è¾‘åªæœ‰ä¸€æ¬¡ï¼Œå¦å¤– <code>nextTick</code> çš„å®ç°æˆ‘ä¹‹åä¼šæŠ½ä¸€å°èŠ‚ä¸“é—¨å»è®²ï¼Œç›®å‰å°±å¯ä»¥ç†è§£å®ƒæ˜¯åœ¨ä¸‹ä¸€ä¸ª tickï¼Œä¹Ÿå°±æ˜¯å¼‚æ­¥çš„å»æ‰§è¡Œ <code>flushSchedulerQueue</code>ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ <code>flushSchedulerQueue</code> çš„å®ç°ï¼Œå®ƒçš„å®šä¹‰åœ¨ <code>src/core/observer/scheduler.js</code> ä¸­ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> flushing <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">/**
 * Flush both queues and run the watchers.
 */</span>
<span class="token keyword">function</span> <span class="token function">flushSchedulerQueue</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  flushing <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">let</span> watcher<span class="token punctuation">,</span> id

  <span class="token comment">// Sort queue before flush.</span>
  <span class="token comment">// This ensures that:</span>
  <span class="token comment">// 1. Components are updated from parent to child. (because parent is always</span>
  <span class="token comment">//    created before the child)</span>
  <span class="token comment">// 2. A component's user watchers are run before its render watcher (because</span>
  <span class="token comment">//    user watchers are created before the render watcher)</span>
  <span class="token comment">// 3. If a component is destroyed during a parent component's watcher run,</span>
  <span class="token comment">//    its watchers can be skipped.</span>
  queue<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>id <span class="token operator">-</span> b<span class="token punctuation">.</span>id<span class="token punctuation">)</span>

  <span class="token comment">// do not cache length because more watchers might be pushed</span>
  <span class="token comment">// as we run existing watchers</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> queue<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    watcher <span class="token operator">=</span> queue<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>before<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      watcher<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id
    has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    watcher<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// in dev build, check and stop circular updates.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>circular<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token constant">MAX_UPDATE_COUNT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span>
          <span class="token string">'You may have an infinite update loop '</span> <span class="token operator">+</span> <span class="token punctuation">(</span>
            watcher<span class="token punctuation">.</span>user
              <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">in watcher with expression &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>watcher<span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span>
              <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">in a component render function.</span><span class="token template-punctuation string">`</span></span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
          watcher<span class="token punctuation">.</span>vm
        <span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// keep copies of post queues before resetting state</span>
  <span class="token keyword">const</span> activatedQueue <span class="token operator">=</span> activatedChildren<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> updatedQueue <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">resetSchedulerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// call component updated and activated hooks</span>
  <span class="token function">callActivatedHooks</span><span class="token punctuation">(</span>activatedQueue<span class="token punctuation">)</span>
  <span class="token function">callUpdatedHooks</span><span class="token punctuation">(</span>updatedQueue<span class="token punctuation">)</span>

  <span class="token comment">// devtool hook</span>
  <span class="token comment">/* istanbul ignore if */</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>devtools <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>devtools<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    devtools<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'flush'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œæœ‰å‡ ä¸ªé‡è¦çš„é€»è¾‘è¦æ¢³ç†ä¸€ä¸‹ï¼Œå¯¹äºä¸€äº›åˆ†æ”¯é€»è¾‘å¦‚ <code>keep-alive</code> ç»„ä»¶ç›¸å…³å’Œä¹‹å‰æåˆ°è¿‡çš„ <code>updated</code> é’©å­å‡½æ•°çš„æ‰§è¡Œä¼šç•¥è¿‡ã€‚</p> <ul><li>é˜Ÿåˆ—æ’åº</li></ul> <p><code>queue.sort((a, b) =&gt; a.id - b.id)</code> å¯¹é˜Ÿåˆ—åšäº†ä»å°åˆ°å¤§çš„æ’åºï¼Œè¿™ä¹ˆåšä¸»è¦æœ‰ä»¥ä¸‹è¦ç¡®ä¿ä»¥ä¸‹å‡ ç‚¹ï¼š</p> <p>1.ç»„ä»¶çš„æ›´æ–°ç”±çˆ¶åˆ°å­ï¼›å› ä¸ºçˆ¶ç»„ä»¶çš„åˆ›å»ºè¿‡ç¨‹æ˜¯å…ˆäºå­çš„ï¼Œæ‰€ä»¥ <code>watcher</code> çš„åˆ›å»ºä¹Ÿæ˜¯å…ˆçˆ¶åå­ï¼Œæ‰§è¡Œé¡ºåºä¹Ÿåº”è¯¥ä¿æŒå…ˆçˆ¶åå­ã€‚</p> <p>2.ç”¨æˆ·çš„è‡ªå®šä¹‰ <code>watcher</code> è¦ä¼˜å…ˆäºæ¸²æŸ“ <code>watcher</code> æ‰§è¡Œï¼›å› ä¸ºç”¨æˆ·è‡ªå®šä¹‰ <code>watcher</code> æ˜¯åœ¨æ¸²æŸ“ <code>watcher</code> ä¹‹å‰åˆ›å»ºçš„ã€‚</p> <p>3.å¦‚æœä¸€ä¸ªç»„ä»¶åœ¨çˆ¶ç»„ä»¶çš„ <code>watcher</code> æ‰§è¡ŒæœŸé—´è¢«é”€æ¯ï¼Œé‚£ä¹ˆå®ƒå¯¹åº”çš„ <code>watcher</code> æ‰§è¡Œéƒ½å¯ä»¥è¢«è·³è¿‡ï¼Œæ‰€ä»¥çˆ¶ç»„ä»¶çš„ <code>watcher</code> åº”è¯¥å…ˆæ‰§è¡Œã€‚</p> <ul><li>é˜Ÿåˆ—éå†</li></ul> <p>åœ¨å¯¹ <code>queue</code> æ’åºåï¼Œæ¥ç€å°±æ˜¯è¦å¯¹å®ƒåšéå†ï¼Œæ‹¿åˆ°å¯¹åº”çš„ <code>watcher</code>ï¼Œæ‰§è¡Œ <code>watcher.run()</code>ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªç»†èŠ‚ï¼Œåœ¨éå†çš„æ—¶å€™æ¯æ¬¡éƒ½ä¼šå¯¹ <code>queue.length</code> æ±‚å€¼ï¼Œå› ä¸ºåœ¨ <code>watcher.run()</code> çš„æ—¶å€™ï¼Œå¾ˆå¯èƒ½ç”¨æˆ·ä¼šå†æ¬¡æ·»åŠ æ–°çš„ <code>watcher</code>ï¼Œè¿™æ ·ä¼šå†æ¬¡æ‰§è¡Œåˆ° <code>queueWatcher</code>ï¼Œå¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">queueWatcher</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">watcher</span><span class="token operator">:</span> Watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id
  <span class="token keyword">if</span> <span class="token punctuation">(</span>has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flushing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// if already flushing, splice the watcher based on its id</span>
      <span class="token comment">// if already past its id, it will be run next immediately.</span>
      <span class="token keyword">let</span> i <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> index <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&gt;</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        i<span class="token operator">--</span>
      <span class="token punctuation">}</span>
      queue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> watcher<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ—¶å€™ <code>flushing</code> ä¸º trueï¼Œå°±ä¼šæ‰§è¡Œåˆ° else çš„é€»è¾‘ï¼Œç„¶åå°±ä¼šä»åå¾€å‰æ‰¾ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¾…æ’å…¥ <code>watcher</code> çš„ id æ¯”å½“å‰é˜Ÿåˆ—ä¸­ <code>watcher</code> çš„ id å¤§çš„ä½ç½®ã€‚æŠŠ <code>watcher</code> æŒ‰ç…§ <code>id</code>çš„æ’å…¥åˆ°é˜Ÿåˆ—ä¸­ï¼Œå› æ­¤ <code>queue</code> çš„é•¿åº¦å‘ç”Ÿäº†å˜åŒ–ã€‚</p> <ul><li>çŠ¶æ€æ¢å¤</li></ul> <p>è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ‰§è¡Œ <code>resetSchedulerState</code> å‡½æ•°ï¼Œå®ƒçš„å®šä¹‰åœ¨ <code>src/core/observer/scheduler.js</code> ä¸­ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token literal-property property">queue</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>Watcher<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> <span class="token literal-property property">has</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">?</span><span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> <span class="token literal-property property">circular</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> number <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> waiting <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> flushing <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">/**
 * Reset the scheduler's state.
 */</span>
<span class="token keyword">function</span> <span class="token function">resetSchedulerState</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  index <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">=</span> activatedChildren<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>
  has <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    circular <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  waiting <span class="token operator">=</span> flushing <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é€»è¾‘éå¸¸ç®€å•ï¼Œå°±æ˜¯æŠŠè¿™äº›æ§åˆ¶æµç¨‹çŠ¶æ€çš„ä¸€äº›å˜é‡æ¢å¤åˆ°åˆå§‹å€¼ï¼ŒæŠŠ <code>watcher</code> é˜Ÿåˆ—æ¸…ç©ºã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­åˆ†æ <code>watcher.run()</code> çš„é€»è¾‘ï¼Œå®ƒçš„å®šä¹‰åœ¨ <code>src/core/observer/watcher.js</code> ä¸­ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Watcher</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * Scheduler job interface.
   * Will be called by the scheduler.
   */</span>
  <span class="token function">run</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>active<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAndInvoke</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cb<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">getAndInvoke</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">cb</span><span class="token operator">:</span> Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      value <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">||</span>
      <span class="token comment">// Deep watchers and watchers on Object/Arrays should fire even</span>
      <span class="token comment">// when the value is the same, because the value may</span>
      <span class="token comment">// have mutated.</span>
      <span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>deep
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// set new value</span>
      <span class="token keyword">const</span> oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
      <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
      <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">callback for watcher &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>run</code> å‡½æ•°å®é™…ä¸Šå°±æ˜¯æ‰§è¡Œ <code>this.getAndInvoke</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥ <code>watcher</code> çš„å›è°ƒå‡½æ•°ã€‚<code>getAndInvoke</code> å‡½æ•°é€»è¾‘ä¹Ÿå¾ˆç®€å•ï¼Œå…ˆé€šè¿‡ <code>this.get()</code> å¾—åˆ°å®ƒå½“å‰çš„å€¼ï¼Œç„¶ååšåˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³æ–°æ—§å€¼ä¸ç­‰ã€æ–°å€¼æ˜¯å¯¹è±¡ç±»å‹ã€<code>deep</code> æ¨¡å¼ä»»ä½•ä¸€ä¸ªæ¡ä»¶ï¼Œåˆ™æ‰§è¡Œ <code>watcher</code> çš„å›è°ƒï¼Œæ³¨æ„å›è°ƒå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ä¼šæŠŠç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥æ–°å€¼ <code>value</code> å’Œæ—§å€¼ <code>oldValue</code>ï¼Œè¿™å°±æ˜¯å½“æˆ‘ä»¬æ·»åŠ è‡ªå®šä¹‰ <code>watcher</code> çš„æ—¶å€™èƒ½åœ¨å›è°ƒå‡½æ•°çš„å‚æ•°ä¸­æ‹¿åˆ°æ–°æ—§å€¼çš„åŸå› ã€‚</p> <p>é‚£ä¹ˆå¯¹äºæ¸²æŸ“ <code>watcher</code> è€Œè¨€ï¼Œå®ƒåœ¨æ‰§è¡Œ <code>this.get()</code> æ–¹æ³•æ±‚å€¼çš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œ <code>getter</code> æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰€ä»¥è¿™å°±æ˜¯å½“æˆ‘ä»¬å»ä¿®æ”¹ç»„ä»¶ç›¸å…³çš„å“åº”å¼æ•°æ®çš„æ—¶å€™ï¼Œä¼šè§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“çš„åŸå› ï¼Œæ¥ç€å°±ä¼šé‡æ–°æ‰§è¡Œ <code>patch</code> çš„è¿‡ç¨‹ï¼Œä½†å®ƒå’Œé¦–æ¬¡æ¸²æŸ“æœ‰æ‰€ä¸åŒï¼Œä¹‹åæˆ‘ä»¬ä¼šèŠ±ä¸€å°èŠ‚å»è¯¦ç»†ä»‹ç»ã€‚</p> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> æ€»ç»“</h2> <p>é€šè¿‡è¿™ä¸€èŠ‚çš„åˆ†æï¼Œæˆ‘ä»¬å¯¹ Vue æ•°æ®ä¿®æ”¹æ´¾å‘æ›´æ–°çš„è¿‡ç¨‹ä¹Ÿæœ‰äº†è®¤è¯†ï¼Œå®é™…ä¸Šå°±æ˜¯å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œè§¦å‘ setter é€»è¾‘ï¼ŒæŠŠåœ¨ä¾èµ–è¿‡ç¨‹ä¸­è®¢é˜…çš„çš„æ‰€æœ‰è§‚å¯Ÿè€…ï¼Œä¹Ÿå°±æ˜¯ <code>watcher</code>ï¼Œéƒ½è§¦å‘å®ƒä»¬çš„ <code>update</code> è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹åˆåˆ©ç”¨äº†é˜Ÿåˆ—åšäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œåœ¨ <code>nextTick</code> åæ‰§è¡Œæ‰€æœ‰ <code>watcher</code> çš„ <code>run</code>ï¼Œæœ€åæ‰§è¡Œå®ƒä»¬çš„å›è°ƒå‡½æ•°ã€‚<code>nextTick</code> æ˜¯ Vue ä¸€ä¸ªæ¯”è¾ƒæ ¸å¿ƒçš„å®ç°äº†ï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æå®ƒçš„å®ç°ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/./vue2/reactive/getters.html" class="prev">
        ä¾èµ–æ”¶é›†
      </a></span> <span class="next"><a href="/./vue2/reactive/next-tick.html">
        nextTick
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.c50cae2e.js" defer></script><script src="./assets/js/4.08095b6d.js" defer></script><script src="./assets/js/69.fffc95ef.js" defer></script>
  </body>
</html>
