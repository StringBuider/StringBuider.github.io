<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>è‡ªå®šä¹‰æ¸²æŸ“å™¨å’Œå¼‚æ­¥æ¸²æŸ“ | å°å¼ çš„å…±äº«æ–‡æ¡£</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="ğŸ¤”ä½ æœ‰ä»€ä¹ˆæƒ³è¯´ï¼Ÿå†™è¿›æ¥å§ï¼ğŸ˜">
    
    <link rel="preload" href="./assets/css/0.styles.a246c231.css" as="style"><link rel="preload" href="./assets/js/app.c50cae2e.js" as="script"><link rel="preload" href="./assets/js/4.08095b6d.js" as="script"><link rel="preload" href="./assets/js/82.23093c7e.js" as="script"><link rel="prefetch" href="./assets/js/10.ed3e9f33.js"><link rel="prefetch" href="./assets/js/11.6495f8ce.js"><link rel="prefetch" href="./assets/js/12.e15e40c1.js"><link rel="prefetch" href="./assets/js/13.33a2b3c3.js"><link rel="prefetch" href="./assets/js/14.5d605ae8.js"><link rel="prefetch" href="./assets/js/15.b5e3a30f.js"><link rel="prefetch" href="./assets/js/16.32bee43d.js"><link rel="prefetch" href="./assets/js/17.67f7f069.js"><link rel="prefetch" href="./assets/js/18.af04d610.js"><link rel="prefetch" href="./assets/js/19.730c3139.js"><link rel="prefetch" href="./assets/js/2.7fc48c46.js"><link rel="prefetch" href="./assets/js/20.1c4fbbf9.js"><link rel="prefetch" href="./assets/js/21.67119724.js"><link rel="prefetch" href="./assets/js/22.c2076f14.js"><link rel="prefetch" href="./assets/js/23.f25b155f.js"><link rel="prefetch" href="./assets/js/24.c8791672.js"><link rel="prefetch" href="./assets/js/25.af22f7f1.js"><link rel="prefetch" href="./assets/js/26.777a42b7.js"><link rel="prefetch" href="./assets/js/27.25c6658f.js"><link rel="prefetch" href="./assets/js/28.4c66a1fb.js"><link rel="prefetch" href="./assets/js/29.45d218cd.js"><link rel="prefetch" href="./assets/js/3.fb9770df.js"><link rel="prefetch" href="./assets/js/30.2cfa5f3d.js"><link rel="prefetch" href="./assets/js/31.9a7819c6.js"><link rel="prefetch" href="./assets/js/32.6b80cecb.js"><link rel="prefetch" href="./assets/js/33.e00e1922.js"><link rel="prefetch" href="./assets/js/34.445fb4ff.js"><link rel="prefetch" href="./assets/js/35.2f86d553.js"><link rel="prefetch" href="./assets/js/36.7e8dc342.js"><link rel="prefetch" href="./assets/js/37.827964ca.js"><link rel="prefetch" href="./assets/js/38.306618b3.js"><link rel="prefetch" href="./assets/js/39.96d345b4.js"><link rel="prefetch" href="./assets/js/40.5327dcb2.js"><link rel="prefetch" href="./assets/js/41.29160afa.js"><link rel="prefetch" href="./assets/js/42.3ec42885.js"><link rel="prefetch" href="./assets/js/43.db7bc261.js"><link rel="prefetch" href="./assets/js/44.60eae751.js"><link rel="prefetch" href="./assets/js/45.15437d11.js"><link rel="prefetch" href="./assets/js/46.55a5744d.js"><link rel="prefetch" href="./assets/js/47.e8e54de1.js"><link rel="prefetch" href="./assets/js/48.97e52f5e.js"><link rel="prefetch" href="./assets/js/49.c58d43a4.js"><link rel="prefetch" href="./assets/js/5.4c884eba.js"><link rel="prefetch" href="./assets/js/50.a93fcdb0.js"><link rel="prefetch" href="./assets/js/51.c43da0f8.js"><link rel="prefetch" href="./assets/js/52.e0cc02e1.js"><link rel="prefetch" href="./assets/js/53.95f0f53a.js"><link rel="prefetch" href="./assets/js/54.c4c47eaf.js"><link rel="prefetch" href="./assets/js/55.b37c9037.js"><link rel="prefetch" href="./assets/js/56.3d8ed2b4.js"><link rel="prefetch" href="./assets/js/57.bd65c07b.js"><link rel="prefetch" href="./assets/js/58.134b9e82.js"><link rel="prefetch" href="./assets/js/59.24c871f7.js"><link rel="prefetch" href="./assets/js/6.4e374fac.js"><link rel="prefetch" href="./assets/js/60.b75523ad.js"><link rel="prefetch" href="./assets/js/61.484be178.js"><link rel="prefetch" href="./assets/js/62.180c4d5d.js"><link rel="prefetch" href="./assets/js/63.c4c8b737.js"><link rel="prefetch" href="./assets/js/64.3921bee2.js"><link rel="prefetch" href="./assets/js/65.8c31bc75.js"><link rel="prefetch" href="./assets/js/66.a5410547.js"><link rel="prefetch" href="./assets/js/67.32e09623.js"><link rel="prefetch" href="./assets/js/68.4d59d330.js"><link rel="prefetch" href="./assets/js/69.fffc95ef.js"><link rel="prefetch" href="./assets/js/7.ef54b1c1.js"><link rel="prefetch" href="./assets/js/70.72980d01.js"><link rel="prefetch" href="./assets/js/71.fbafa4c6.js"><link rel="prefetch" href="./assets/js/72.59e84ead.js"><link rel="prefetch" href="./assets/js/73.62c6073a.js"><link rel="prefetch" href="./assets/js/74.098849aa.js"><link rel="prefetch" href="./assets/js/75.c4126dcd.js"><link rel="prefetch" href="./assets/js/76.288ce637.js"><link rel="prefetch" href="./assets/js/77.405cc8e4.js"><link rel="prefetch" href="./assets/js/78.f092ec42.js"><link rel="prefetch" href="./assets/js/79.5965beb6.js"><link rel="prefetch" href="./assets/js/8.1e8a08c7.js"><link rel="prefetch" href="./assets/js/80.b06d3623.js"><link rel="prefetch" href="./assets/js/81.7e1c12fd.js"><link rel="prefetch" href="./assets/js/9.07409efc.js">
    <link rel="stylesheet" href="./assets/css/0.styles.a246c231.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/./" class="home-link router-link-active"><!----> <span class="site-name">å°å¼ çš„å…±äº«æ–‡æ¡£</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/./" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŒ‡å—" class="dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow down"></span></button> <button type="button" aria-label="æŒ‡å—" class="mobile-dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./guide/getting-started.html" class="nav-link">
  å‚ä¸å†™ä½œ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends.html" class="nav-link">
  å¾®å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends-faq.html" class="nav-link">
  å¾®å‰ç«¯FAQ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/git-flow.html" class="nav-link">
  å·¥ä½œæµ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è§„èŒƒ" class="dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="è§„èŒƒ" class="mobile-dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-route.html" class="nav-link">
  å¾®å‰ç«¯-è·¯ç”±è§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-version-control.html" class="nav-link">
  å¾®å‰ç«¯-ç‰ˆæœ¬ç®¡ç†
</a></li><li class="dropdown-item"><!----> <a href="/./standard/typescript.html" class="nav-link">
  TypeScriptè§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/code-version-control.html" class="nav-link">
  ä»£ç åˆ†æ”¯ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tips" class="dropdown-title"><span class="title">tips</span> <span class="arrow down"></span></button> <button type="button" aria-label="tips" class="mobile-dropdown-title"><span class="title">tips</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./tips/url-mode.html" class="nav-link">
  urlæ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ’ä»¶" class="dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ’ä»¶" class="mobile-dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./plugins/plugin.html" class="nav-link">
  æ’ä»¶åˆ†äº«
</a></li></ul></div></div><div class="nav-item"><a href="/./vue2/prepare/" class="nav-link">
  vue2.x
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue3.x" class="dropdown-title"><span class="title">vue3.x</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue3.x" class="mobile-dropdown-title"><span class="title">vue3.x</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./vue3/essence-of-comp.html" class="nav-link">
  ç»„ä»¶çš„æœ¬è´¨
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/vnode.html" class="nav-link">
  æŠŠVNodeè§£å‰–ä¸€ä¸‹
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/h.html" class="nav-link">
  è¾…åŠ©åˆ›å»º VNode çš„ h å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/observer.html" class="nav-link">
  å“åº”å¼åŸç†
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹æŒ‚è½½
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-patch.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹patch
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-diff.html" class="nav-link">
  æ¸²æŸ“å™¨çš„æ ¸å¿ƒ Diff ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-advanced.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  è‡ªå®šä¹‰æ¸²æŸ“å™¨
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="mobile-dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./basic/basic.html" class="nav-link">
  å…«è‚¡æ–‡
</a></li><li class="dropdown-item"><!----> <a href="/./basic/arithmetic.html" class="nav-link">
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./basic/desinmode.html" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•ç»éªŒ" class="dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="é¢è¯•ç»éªŒ" class="mobile-dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./interview/interview.html" class="nav-link">
  é¢è¯•ç»éªŒ
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/./" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŒ‡å—" class="dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow down"></span></button> <button type="button" aria-label="æŒ‡å—" class="mobile-dropdown-title"><span class="title">æŒ‡å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./guide/getting-started.html" class="nav-link">
  å‚ä¸å†™ä½œ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends.html" class="nav-link">
  å¾®å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/./guide/micro-frontends-faq.html" class="nav-link">
  å¾®å‰ç«¯FAQ
</a></li><li class="dropdown-item"><!----> <a href="/./guide/git-flow.html" class="nav-link">
  å·¥ä½œæµ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="è§„èŒƒ" class="dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="è§„èŒƒ" class="mobile-dropdown-title"><span class="title">è§„èŒƒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-route.html" class="nav-link">
  å¾®å‰ç«¯-è·¯ç”±è§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/micro-frontends-version-control.html" class="nav-link">
  å¾®å‰ç«¯-ç‰ˆæœ¬ç®¡ç†
</a></li><li class="dropdown-item"><!----> <a href="/./standard/typescript.html" class="nav-link">
  TypeScriptè§„èŒƒ
</a></li><li class="dropdown-item"><!----> <a href="/./standard/code-version-control.html" class="nav-link">
  ä»£ç åˆ†æ”¯ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="tips" class="dropdown-title"><span class="title">tips</span> <span class="arrow down"></span></button> <button type="button" aria-label="tips" class="mobile-dropdown-title"><span class="title">tips</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./tips/url-mode.html" class="nav-link">
  urlæ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ’ä»¶" class="dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ’ä»¶" class="mobile-dropdown-title"><span class="title">æ’ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./plugins/plugin.html" class="nav-link">
  æ’ä»¶åˆ†äº«
</a></li></ul></div></div><div class="nav-item"><a href="/./vue2/prepare/" class="nav-link">
  vue2.x
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue3.x" class="dropdown-title"><span class="title">vue3.x</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue3.x" class="mobile-dropdown-title"><span class="title">vue3.x</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./vue3/essence-of-comp.html" class="nav-link">
  ç»„ä»¶çš„æœ¬è´¨
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/vnode.html" class="nav-link">
  æŠŠVNodeè§£å‰–ä¸€ä¸‹
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/h.html" class="nav-link">
  è¾…åŠ©åˆ›å»º VNode çš„ h å‡½æ•°
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/observer.html" class="nav-link">
  å“åº”å¼åŸç†
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹æŒ‚è½½
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-patch.html" class="nav-link">
  æ¸²æŸ“å™¨ä¹‹patch
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-diff.html" class="nav-link">
  æ¸²æŸ“å™¨çš„æ ¸å¿ƒ Diff ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./vue3/renderer-advanced.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  è‡ªå®šä¹‰æ¸²æŸ“å™¨
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯å…«è‚¡æ–‡" class="mobile-dropdown-title"><span class="title">å‰ç«¯å…«è‚¡æ–‡</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./basic/basic.html" class="nav-link">
  å…«è‚¡æ–‡
</a></li><li class="dropdown-item"><!----> <a href="/./basic/arithmetic.html" class="nav-link">
  ç®—æ³•
</a></li><li class="dropdown-item"><!----> <a href="/./basic/desinmode.html" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é¢è¯•ç»éªŒ" class="dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow down"></span></button> <button type="button" aria-label="é¢è¯•ç»éªŒ" class="mobile-dropdown-title"><span class="title">é¢è¯•ç»éªŒ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/./interview/interview.html" class="nav-link">
  é¢è¯•ç»éªŒ
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/./vue3/essence-of-comp.html" class="sidebar-link">ç»„ä»¶çš„æœ¬è´¨</a></li><li><a href="/./vue3/vnode.html" class="sidebar-link">æŠŠ VNode è§£å‰–ä¸€ä¸‹</a></li><li><a href="/./vue3/h.html" class="sidebar-link">è¾…åŠ©åˆ›å»º VNode çš„ h å‡½æ•°</a></li><li><a href="/./vue3/observer.html" class="sidebar-link">åŸºäº Proxy çš„å“åº”ç³»ç»Ÿ</a></li><li><a href="/./vue3/renderer.html" class="sidebar-link">æ¸²æŸ“å™¨ä¹‹æŒ‚è½½</a></li><li><a href="/./vue3/renderer-patch.html" class="sidebar-link">æ¸²æŸ“å™¨ä¹‹patch</a></li><li><a href="/./vue3/renderer-diff.html" class="sidebar-link">æ¸²æŸ“å™¨çš„æ ¸å¿ƒ Diff ç®—æ³•</a></li><li><a href="/./vue3/renderer-advanced.html" aria-current="page" class="active sidebar-link">è‡ªå®šä¹‰æ¸²æŸ“å™¨å’Œå¼‚æ­¥æ¸²æŸ“</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/./vue3/renderer-advanced.html#è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åŸç†" class="sidebar-link">è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åŸç†</a></li><li class="sidebar-sub-header"><a href="/./vue3/renderer-advanced.html#è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨" class="sidebar-link">è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨</a></li><li class="sidebar-sub-header"><a href="/./vue3/renderer-advanced.html#references" class="sidebar-link">References</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="è‡ªå®šä¹‰æ¸²æŸ“å™¨å’Œå¼‚æ­¥æ¸²æŸ“"><a href="#è‡ªå®šä¹‰æ¸²æŸ“å™¨å’Œå¼‚æ­¥æ¸²æŸ“" class="header-anchor">#</a> è‡ªå®šä¹‰æ¸²æŸ“å™¨å’Œå¼‚æ­¥æ¸²æŸ“</h1> <p>åœ¨æœ¬ç« ä¹‹å‰ï¼Œæˆ‘ä»¬èŠ±è´¹äº†å¾ˆå¤§çš„ç¯‡å¹…å…¨é¢çš„è®²è§£äº†ä¸€ä¸ªæ™®é€šæ¸²æŸ“å™¨çš„å®ç°åŸç†ï¼Œå®ƒå¯ä»¥å°† <code>Virtual DOM</code> æ¸²æŸ“ä¸º Web å¹³å°çš„çœŸå® DOMã€‚æœ¬ç« æˆ‘ä»¬å°†åœ¨ä¸Šä¸€ç« çš„åŸºç¡€ä¸Šè®²è§£æ›´åŠ é«˜çº§çš„æ¸²æŸ“å™¨ï¼šè‡ªå®šä¹‰æ¸²æŸ“å™¨(<code>Custom renderer</code>)ä»¥åŠå¼‚æ­¥æ¸²æŸ“ã€‚</p> <h2 id="è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åŸç†"><a href="#è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åŸç†" class="header-anchor">#</a> è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åŸç†</h2> <p>æ¸²æŸ“å™¨æ˜¯å›´ç»• <code>Virtual DOM</code> è€Œå­˜åœ¨çš„ï¼Œåœ¨ Web å¹³å°ä¸‹å®ƒèƒ½å¤ŸæŠŠ <code>Virtual DOM</code> æ¸²æŸ“ä¸ºæµè§ˆå™¨ä¸­çš„çœŸå® DOM å¯¹è±¡ï¼Œé€šè¿‡å‰é¢å‡ ç« çš„è®²è§£ï¼Œç›¸ä¿¡ä½ å·²ç»èƒ½å¤Ÿè®¤è¯†åˆ°æ¸²æŸ“å™¨çš„å®ç°åŸç†ï¼Œä¸ºäº†èƒ½å¤Ÿå°† <code>Virtual DOM</code> æ¸²æŸ“ä¸ºçœŸå® DOMï¼Œæ¸²æŸ“å™¨å†…éƒ¨éœ€è¦è°ƒç”¨æµè§ˆå™¨æä¾›çš„ DOM ç¼–ç¨‹æ¥å£ï¼Œä¸‹é¢ç½—åˆ—äº†åœ¨å‡ºä¸Šä¸€ç« ä¸­æˆ‘ä»¬æ›¾ç»ä½¿ç”¨åˆ°çš„é‚£äº›æµè§ˆå™¨ä¸ºæˆ‘ä»¬æä¾›çš„ DOM ç¼–ç¨‹æ¥å£ï¼š</p> <ul><li><code>document.createElement / createElementNS</code>ï¼šåˆ›å»ºæ ‡ç­¾å…ƒç´ ã€‚</li> <li><code>document.createTextNode</code>ï¼šåˆ›å»ºæ–‡æœ¬å…ƒç´ ã€‚</li> <li><code>el.nodeValue</code>ï¼šä¿®æ”¹æ–‡æœ¬å…ƒç´ çš„å†…å®¹ã€‚</li> <li><code>el.removeChild</code>ï¼šç§»é™¤ DOM å…ƒç´ ã€‚</li> <li><code>el.insertBefore</code>ï¼šæ’å…¥ DOM å…ƒç´ ã€‚</li> <li><code>el.appendChild</code>ï¼šè¿½åŠ  DOM å…ƒç´ ã€‚</li> <li><code>el.parentNode</code>ï¼šè·å–çˆ¶å…ƒç´ ã€‚</li> <li><code>el.nextSibling</code>ï¼šè·å–ä¸‹ä¸€ä¸ªå…„å¼Ÿå…ƒç´ ã€‚</li> <li><code>document.querySelector</code>ï¼šæŒ‚è½½ <code>Portal</code> ç±»å‹çš„ <code>VNode</code> æ—¶ï¼Œç”¨å®ƒæŸ¥æ‰¾æŒ‚è½½ç‚¹ã€‚</li></ul> <p>è¿™äº› DOM ç¼–ç¨‹æ¥å£å®Œæˆäº† Web å¹³å°(æˆ–è€…è¯´æµè§ˆå™¨)ä¸‹å¯¹ DOM çš„å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾çš„å·¥ä½œï¼Œå®ƒæ˜¯ Web å¹³å°ç‹¬æœ‰çš„ï¼Œæ‰€ä»¥å¦‚æœæ¸²æŸ“å™¨è‡ªèº«å¼ºä¾èµ–äºè¿™äº›æ–¹æ³•(å‡½æ•°)ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¸²æŸ“å™¨ä¹Ÿåªèƒ½å¤Ÿè¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå®ƒä¸å…·å¤‡è·¨å¹³å°çš„èƒ½åŠ›ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¹³å°æ— å…³çš„æ¸²æŸ“å™¨ï¼Œé‚£ä¹ˆæ¸²æŸ“å™¨è‡ªèº«å¿…é¡»ä¸èƒ½å¼ºä¾èµ–äºä»»ä½•ä¸€ä¸ªå¹³å°ä¸‹ç‰¹æœ‰çš„æ¥å£ï¼Œè€Œæ˜¯åº”è¯¥æä¾›ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå°† â€œDOMâ€ çš„å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾ç­‰æ“ä½œä½¿ç”¨æŠ½è±¡æ¥å£å®ç°ï¼Œå…·ä½“åˆ°æŸä¸ªå¹³å°ä¸‹æ—¶ï¼Œç”±å¼€å‘è€…å†³å®šå¦‚ä½•ä½¿ç”¨è¯¥å¹³å°ä¸‹çš„æ¥å£å®ç°è¿™ä¸ªæŠ½è±¡å±‚ï¼Œè¿™å°±æ˜¯è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„æœ¬è´¨ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>åœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ â€œå…ƒç´ â€ ä¸€è¯æŒ‡ä»£æ‰€æœ‰å¹³å°ä¸­çš„å…ƒç´ å¯¹è±¡ï¼Œä¾‹å¦‚åœ¨ Web å¹³å°ä¸‹ â€œå…ƒç´ â€ ä¸€è¯æŒ‡çš„å°±æ˜¯ DOM å…ƒç´ ã€‚</p></div> <p>æ¸²æŸ“å™¨é™¤äº†è´Ÿè´£å¯¹å…ƒç´ çš„å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾ä¹‹å¤–ï¼Œå®ƒè¿˜è´Ÿè´£ä¿®æ”¹æŸä¸ªç‰¹å®šå…ƒç´ è‡ªèº«çš„å±æ€§/ç‰¹æ€§ï¼Œä¾‹å¦‚ Web å¹³å°ä¸­å…ƒç´ å…·æœ‰ <code>id</code>ã€<code>href</code> ç­‰å±æ€§/ç‰¹æ€§ã€‚åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>patchData</code> å‡½æ•°æ¥å®Œæˆå…ƒç´ è‡ªèº«å±æ€§/ç‰¹æ€§çš„æ›´æ–°ï¼Œå¦‚ä¸‹ä»£ç ç”¨äºä¿®æ”¹ä¸€ä¸ªå…ƒç´ çš„ç±»ååˆ—è¡¨(<code>class</code>)ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// patchData.js</span>
<span class="token keyword">case</span> <span class="token string">'class'</span><span class="token operator">:</span>
  el<span class="token punctuation">.</span>className <span class="token operator">=</span> nextValue
  <span class="token keyword">break</span>
</code></pre></div><p>è¿™æ®µä»£ç åŒæ ·ä¹Ÿåªèƒ½è¿è¡Œåœ¨æµè§ˆå™¨ä¸­ï¼Œä¸ºäº†æ¸²æŸ“å™¨èƒ½å¤Ÿè·¨å¹³å°ï¼Œé‚£ä¹ˆä¿®æ”¹ä¸€ä¸ªå…ƒç´ è‡ªèº«çš„å±æ€§/ç‰¹æ€§çš„å·¥ä½œä¹Ÿåº”è¯¥ä½œä¸ºå¯è‡ªå®šä¹‰çš„ä¸€éƒ¨åˆ†æ‰è¡Œï¼Œå› æ­¤ï¼Œä¸€ä¸ªè·¨å¹³å°çš„æ¸²æŸ“å™¨åº”è¯¥è‡³å°‘åŒ…å«ä¸¤ä¸ªå¯è‡ªå®šä¹‰çš„éƒ¨åˆ†ï¼š<strong>å¯è‡ªå®šä¹‰å…ƒç´ çš„å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾ç­‰æ“ä½œ</strong>ã€<strong>å¯è‡ªå®šä¹‰å…ƒç´ è‡ªèº«å±æ€§/ç‰¹æ€§çš„ä¿®æ”¹æ“ä½œ</strong>ã€‚è¿™æ ·å¯¹äºä»»ä½•ä¸€ä¸ªå…ƒç´ æ¥è¯´ï¼Œå®ƒçš„å¢åˆ æ”¹æŸ¥éƒ½å·²ç»å˜æˆäº†å¯è‡ªå®šä¹‰çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬åªéœ€è¦â€œå‘ŠçŸ¥â€æ¸²æŸ“å™¨åœ¨å¯¹å…ƒç´ è¿›è¡Œå¢åˆ æ”¹æŸ¥æ—¶åº”è¯¥åšå“ªäº›å…·ä½“çš„æ“ä½œå³å¯ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±ç€æ‰‹å°†ä¸€ä¸ªæ™®é€šæ¸²æŸ“å™¨ä¿®æ”¹ä¸ºæ‹¥æœ‰è‡ªå®šä¹‰èƒ½åŠ›çš„æ¸²æŸ“å™¨ï¼Œåœ¨ä¹‹å‰çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬å°†æ¸²æŸ“å™¨çš„ä»£ç å­˜æ”¾åœ¨äº† <code>render.js</code> æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹æ˜¯æ•´ä¸ª <code>render.js</code> æ–‡ä»¶çš„æ ¸å¿ƒä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¯¼å‡ºæ¸²æŸ“å™¨</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token comment">// ========== æŒ‚è½½ ==========</span>

<span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> refNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> refNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountText</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountFragment</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountPortal</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountStatefulComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mountFunctionalComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token comment">// ========== patch ==========</span>

<span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">replaceVNode</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">patchElement</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">patchChildren</span><span class="token punctuation">(</span>
  <span class="token parameter">prevChildFlags<span class="token punctuation">,</span>
  nextChildFlags<span class="token punctuation">,</span>
  prevChildren<span class="token punctuation">,</span>
  nextChildren<span class="token punctuation">,</span>
  container</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">patchText</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">patchFragment</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">patchPortal</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">patchComponent</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

<span class="token comment">// https://en.wikipedia.org/wiki/Longest_increasing_subsequence</span>
<span class="token keyword">function</span> <span class="token function">lis</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
</code></pre></div><p>è§‚å¯Ÿå¦‚ä¸Šä»£ç ç»“æ„ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªæ¸²æŸ“å™¨ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š<code>mount</code> å’Œ <code>patch</code>ã€‚åœ¨ <code>mount</code> å’Œ <code>patch</code> ä¸­éƒ½ä¼šè°ƒç”¨æµè§ˆå™¨æä¾›çš„ DOM ç¼–ç¨‹æ¥å£æ¥å®ŒæˆçœŸæ­£çš„æ¸²æŸ“å·¥ä½œã€‚ä¸ºäº†å°†æµè§ˆå™¨æä¾›çš„ DOM ç¼–ç¨‹æ¥å£ä¸æ¸²æŸ“å™¨çš„ä»£ç åˆ†ç¦»ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¦‚ä¸Šä»£ç å°è£…åˆ°ä¸€ä¸ªå«åš <code>createRenderer</code> çš„å‡½æ•°ä¸­ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token comment">// ========== æŒ‚è½½ ==========</span>

  <span class="token keyword">function</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> refNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> refNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountText</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountFragment</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountPortal</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountStatefulComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">mountFunctionalComponent</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token comment">// ========== patch ==========</span>

  <span class="token keyword">function</span> <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">replaceVNode</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">patchElement</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">patchChildren</span><span class="token punctuation">(</span>
    <span class="token parameter">prevChildFlags<span class="token punctuation">,</span>
    nextChildFlags<span class="token punctuation">,</span>
    prevChildren<span class="token punctuation">,</span>
    nextChildren<span class="token punctuation">,</span>
    container</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">patchText</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">patchFragment</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">patchPortal</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">patchComponent</span><span class="token punctuation">(</span><span class="token parameter">prevVNode<span class="token punctuation">,</span> nextVNode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// https://en.wikipedia.org/wiki/Longest_increasing_subsequence</span>
<span class="token keyword">function</span> <span class="token function">lis</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
</code></pre></div><p><code>createRenderer</code> å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯ä¹‹å‰çš„ <code>render</code> å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´è°ƒç”¨ <code>createRenderer</code> å‡½æ•°å¯ä»¥åˆ›å»ºä¸€ä¸ªæ¸²æŸ“å™¨ã€‚<code>createRenderer</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•° <code>options</code>ï¼Œè¯¥å‚æ•°çš„ä½œç”¨æ˜¯ä¸ºäº†å…è®¸å¤–ç•Œæœ‰èƒ½åŠ›å°†æ“ä½œå…ƒç´ çš„å…·ä½“å®ç°ä»¥é€‰é¡¹çš„æ–¹å¼ä¼ é€’è¿›æ¥ã€‚</p> <p>é‚£ä¹ˆ <code>options</code> å‚æ•°ä¸­åº”è¯¥åŒ…å«å“ªäº›é€‰é¡¹å‘¢ï¼Ÿå…¶å®å‰é¢æˆ‘ä»¬å·²ç»åˆ†æè¿‡äº†ï¼Œåªè¦æ˜¯éœ€è¦è‡ªå®šä¹‰çš„éƒ¨åˆ†å°±åº”è¯¥ä½œä¸ºé€‰é¡¹ä¼ é€’è¿›æ¥ï¼Œæ‰€ä»¥å‚æ•° <code>options</code> ä¸­è‡³å°‘è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†æ˜¯å…ƒç´ çš„å¢åŠ ã€åˆ é™¤ã€æŸ¥æ‰¾ï¼›å¦å¤–ä¸€éƒ¨åˆ†æ˜¯å…ƒç´ çš„ä¿®æ”¹ï¼Œå³ <code>patchData</code> å‡½æ•°ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// nodeOps æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†æ‰€æœ‰ç”¨äºæ“ä½œèŠ‚ç‚¹çš„æ–¹æ³•</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
    <span class="token comment">// more...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  patchData
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>åŸºäºæ­¤ï¼Œåœ¨ <code>createRenderer</code> å‡½æ•°å†…éƒ¨æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è§£æ„çš„æ–¹å¼ä» <code>options</code> å‚æ•°ä¸­å¾—åˆ°å…·ä½“çš„æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// options.nodeOps é€‰é¡¹ä¸­åŒ…å«äº†æœ¬ç« å¼€å¤´ç½—åˆ—çš„æ‰€æœ‰æ“ä½œ DOM çš„æ–¹æ³•</span>
  <span class="token comment">// options.patchData é€‰é¡¹å°±æ˜¯ patchData å‡½æ•°</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">createElement</span><span class="token operator">:</span> platformCreateElement<span class="token punctuation">,</span>
      <span class="token literal-property property">createText</span><span class="token operator">:</span> platformCreateText<span class="token punctuation">,</span>
      <span class="token literal-property property">setText</span><span class="token operator">:</span> platformSetText<span class="token punctuation">,</span> <span class="token comment">// ç­‰ä»·äº Web å¹³å°çš„ el.nodeValue</span>
      <span class="token literal-property property">appendChild</span><span class="token operator">:</span> platformAppendChild<span class="token punctuation">,</span>
      <span class="token literal-property property">insertBefore</span><span class="token operator">:</span> platformInsertBefore<span class="token punctuation">,</span>
      <span class="token literal-property property">removeChild</span><span class="token operator">:</span> platformRemoveChild<span class="token punctuation">,</span>
      <span class="token literal-property property">parentNode</span><span class="token operator">:</span> platformParentNode<span class="token punctuation">,</span>
      <span class="token literal-property property">nextSibling</span><span class="token operator">:</span> platformNextSibling<span class="token punctuation">,</span>
      <span class="token literal-property property">querySelector</span><span class="token operator">:</span> platformQuerySelector
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">patchData</span><span class="token operator">:</span> platformPatchData
  <span class="token punctuation">}</span> <span class="token operator">=</span> options

  <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>

  <span class="token comment">// ========== æŒ‚è½½ ==========</span>
  <span class="token comment">// çœç•¥...</span>

  <span class="token comment">// ========== patch ==========</span>
  <span class="token comment">// çœç•¥...</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œ<code>options.nodeOps</code> é€‰é¡¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰ç”¨äºå¯¹å…ƒç´ è¿›è¡Œå¢ã€åˆ ã€æŸ¥çš„æ“ä½œï¼Œ<code>options.patchData</code> é€‰é¡¹æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¤„ç†æŸä¸ªç‰¹å®šå…ƒç´ ä¸Šçš„å±æ€§/ç‰¹å®šï¼Œè¿™äº›å†…å®¹éƒ½æ˜¯åœ¨åˆ›å»ºæ¸²æŸ“å™¨æ—¶ç”±å¤–ç•Œæ¥å†³å®šçš„ã€‚</p> <p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†æ¸²æŸ“å™¨ä¸­åŸæœ¬ä½¿ç”¨äº† Web å¹³å°è¿›è¡Œ DOM æ“ä½œçš„åœ°æ–¹ä¿®æ”¹æˆä½¿ç”¨é€šè¿‡è§£æ„å¾—åˆ°çš„å‡½æ•°è¿›è¡Œæ›¿ä»£ï¼Œä¾‹å¦‚åœ¨åˆ›å»º DOM å…ƒç´ æ—¶ï¼ŒåŸæ¥çš„å®ç°å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> refNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isSVG <span class="token operator">=</span> isSVG <span class="token operator">||</span> vnode<span class="token punctuation">.</span>flags <span class="token operator">&amp;</span> VNodeFlags<span class="token punctuation">.</span><span class="token constant">ELEMENT_SVG</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> isSVG
    <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">'http://www.w3.org/2000/svg'</span><span class="token punctuation">,</span> vnode<span class="token punctuation">.</span>tag<span class="token punctuation">)</span>
    <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>tag<span class="token punctuation">)</span>
  <span class="token comment">// çœç•¥...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ <code>platformCreateElement</code> å‡½æ•°æ›¿ä»£ <code>document.createElement(NS)</code>ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><div class="highlighted">Â </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mountElement</span><span class="token punctuation">(</span><span class="token parameter">vnode<span class="token punctuation">,</span> container<span class="token punctuation">,</span> isSVG<span class="token punctuation">,</span> refNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  isSVG <span class="token operator">=</span> isSVG <span class="token operator">||</span> vnode<span class="token punctuation">.</span>flags <span class="token operator">&amp;</span> VNodeFlags<span class="token punctuation">.</span><span class="token constant">ELEMENT_SVG</span>
  <span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token function">platformCreateElement</span><span class="token punctuation">(</span>vnode<span class="token punctuation">.</span>tag<span class="token punctuation">,</span> isSVG<span class="token punctuation">)</span>
  <span class="token comment">// çœç•¥...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç±»ä¼¼çš„ï¼Œå…¶ä»–æ‰€æœ‰æ¶‰åŠ DOM æ“ä½œçš„åœ°æ–¹éƒ½åº”è¯¥ä½¿ç”¨è¿™äº›é€šè¿‡è§£æ„å¾—åˆ°çš„æŠ½è±¡æ¥å£æ›¿ä»£ã€‚å½“è¿™éƒ¨åˆ†å·¥ä½œå®Œæˆä¹‹åï¼Œæ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯å¯¹è¿™äº›ç”¨äºæ“ä½œèŠ‚ç‚¹çš„æŠ½è±¡æ–¹æ³•è¿›è¡Œå®ç°ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬å®ç°äº† Web å¹³å°ä¸‹åˆ›å»º DOM èŠ‚ç‚¹çš„æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> isSVG
        <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">'http://www.w3.org/2000/svg'</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span>
        <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™æ¡è¯­å¥æ˜¯æˆ‘ä»¬ä¹‹å‰å®ç°çš„æ¸²æŸ“å™¨ä¸­ç”¨äºç§»é™¤æ—§ <code>children</code> ä¸­èŠ‚ç‚¹çš„ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>container<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>prevChildren<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
</code></pre></div><p>ç°åœ¨æˆ‘ä»¬å°†ä¹‹æ›¿æ¢ä¸º <code>platformRemoveChild</code> å‡½æ•°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">platformRemoveChild</span><span class="token punctuation">(</span>container<span class="token punctuation">,</span> prevVNode<span class="token punctuation">.</span>el<span class="token punctuation">)</span>
</code></pre></div><p>ä¸ºäº†è®©è¿™æ®µä»£ç åœ¨ Web å¹³å°æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºæ¸²æŸ“å™¨æ—¶å®ç° <code>nodeOps.removeChild</code> å‡½æ•°ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> isSVG
        <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">'http://www.w3.org/2000/svg'</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span>
        <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä¹Ÿè®¸ä½ å·²ç»æƒ³åˆ°äº†ï¼Œå½“æˆ‘ä»¬å®ç°äº†æ‰€æœ‰ <code>nodeOps</code> ä¸‹çš„è§„å®šçš„æŠ½è±¡æ¥å£ä¹‹åï¼Œå®é™…ä¸Šå°±å®Œæˆäº†ä¸€ä¸ªé¢å‘ Web å¹³å°çš„æ¸²æŸ“å™¨ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> isSVG
        <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">'http://www.w3.org/2000/svg'</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span>
        <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parent<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createText</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">setText</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      node<span class="token punctuation">.</span>nodeValue <span class="token operator">=</span> text
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">insertBefore</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      parent<span class="token punctuation">.</span><span class="token function">insertBefore</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> ref<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">parentNode</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> node<span class="token punctuation">.</span>parentNode
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">nextSibling</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> node<span class="token punctuation">.</span>nextSibling
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å½“ç„¶äº†ï¼Œå¦‚ä¸Šä»£ç æ‰€åˆ›å»ºçš„æ¸²æŸ“å™¨åªèƒ½å¤Ÿå®Œæˆ Web å¹³å°ä¸­å¯¹ DOM çš„å¢åŠ ã€åˆ é™¤å’ŒæŸ¥æ‰¾çš„åŠŸèƒ½ï¼Œä¸ºäº†èƒ½å¤Ÿä¿®æ”¹ DOM å…ƒç´ è‡ªèº«çš„å±æ€§å’Œç‰¹æ€§ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨åˆ›å»ºæ¸²æŸ“å™¨æ—¶å°† <code>patchData</code> å‡½æ•°ä½œä¸ºé€‰é¡¹ä¼ é€’è¿‡å»ï¼Œå¥½åœ¨æˆ‘ä»¬ä¹‹å‰å·²ç»å°è£…äº† <code>patchData</code> å‡½æ•°ï¼Œç°åœ¨ç›´æ¥æ‹¿è¿‡æ¥ç”¨å³å¯ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><div class="highlighted">Â </div><br><br><br><br><div class="highlighted">Â </div><br><br></div><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> patchData <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./patchData'</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// çœç•¥...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  patchData
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®Œæ•´ä»£ç &amp;åœ¨çº¿ä½“éªŒåœ°å€ï¼š<a href="https://codesandbox.io/s/mq8v65qyry" target="_blank" rel="noopener noreferrer">https://codesandbox.io/s/mq8v65qyry<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>ä»¥ä¸Šæˆ‘ä»¬å°±å®Œæˆäº†å¯¹æ¸²æŸ“å™¨çš„æŠ½è±¡ï¼Œä½¿å®ƒæˆä¸ºä¸€ä¸ªå¹³å°æ— å…³çš„å·¥å…·ã€‚å¹¶åŸºäºæ­¤å®ç°äº†ä¸€ä¸ª Web å¹³å°çš„æ¸²æŸ“å™¨ï¼Œä¸“é—¨ç”¨äºæµè§ˆå™¨ç¯å¢ƒã€‚</p> <h2 id="è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨"><a href="#è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨" class="header-anchor">#</a> è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨</h2> <p><code>Vue3</code> æä¾›äº†ä¸€ä¸ªå«åš <code>@vue/runtime-test</code> çš„åŒ…ï¼Œå…¶ä½œç”¨æ˜¯æ–¹ä¾¿å¼€å‘è€…åœ¨æ—  DOM ç¯å¢ƒæ—¶æœ‰èƒ½åŠ›å¯¹ç»„ä»¶çš„æ¸²æŸ“å†…å®¹è¿›è¡Œæµ‹è¯•ï¼Œè¿™å®é™…ä¸Šå°±æ˜¯å¯¹è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨ã€‚æœ¬èŠ‚æˆ‘ä»¬å°è¯•æ¥å®ç°ä¸ <code>@vue/runtime-test</code> å…·æœ‰ç›¸åŒåŠŸèƒ½çš„æ¸²æŸ“å™¨ã€‚</p> <p>åŸç†å…¶å®å¾ˆç®€å•ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼Œè¿™æ˜¯ç”¨äº Web å¹³å°ä¸‹åˆ›å»ºçœŸå® DOM å…ƒç´ çš„ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag<span class="token punctuation">,</span> isSVG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> isSVG
        <span class="token operator">?</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">'http://www.w3.org/2000/svg'</span><span class="token punctuation">,</span> tag<span class="token punctuation">)</span>
        <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å…¶ä¸­ <code>nodeOps.createElement</code> å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªçœŸå®çš„ DOM å¯¹è±¡ï¼Œåœ¨å…¶å†…éƒ¨è°ƒç”¨çš„æ˜¯æµè§ˆå™¨ä¸ºæˆ‘ä»¬æä¾›çš„ <code>document.createElement/NS</code> å‡½æ•°ã€‚å®é™…ä¸Š <code>nodeOps.createElement</code> å‡½æ•°çš„çœŸæ­£æ„å›¾æ˜¯ï¼š<strong>åˆ›å»ºä¸€ä¸ªå…ƒç´ </strong>ï¼Œç„¶è€Œå¹¶æ²¡æœ‰è§„å®šè¿™ä¸ªå…ƒç´ åº”è¯¥ç”±è°æ¥åˆ›å»ºï¼Œæˆ–è¿™ä¸ªå…ƒç´ åº”è¯¥å…·æœ‰ä»€ä¹ˆæ ·çš„ç‰¹å¾ï¼Œè¿™å°±æ˜¯è‡ªå®šä¹‰çš„æ ¸å¿ƒæ‰€åœ¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å®Œå…¨ä½¿ <code>nodeOps.createElement</code> å‡½æ•°è¿”å›ä¸€ä¸ªæ™®é€šå¯¹è±¡æ¥ä»£æŒ‡ä¸€ä¸ªå…ƒç´ ï¼Œåç»­çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸºäºæˆ‘ä»¬æ‰€è§„å®šçš„å…ƒç´ è€Œè¿›è¡Œï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'ELEMENT'</span><span class="token punctuation">,</span>
        tag
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬è‡ªè¡Œè§„å®šäº† <code>nodeOps.createElement</code> å‡½æ•°æ‰€è¿”å›çš„å…ƒç´ çš„æ ¼å¼ï¼Œå³ <code>customElement</code> å¯¹è±¡ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯ ç”¨æ¥ä»£è¡¨å…ƒç´ ç±»å‹çš„ <code>type</code> å±æ€§ä»¥åŠç”¨æ¥ä»£è¡¨å…ƒç´ åç§°çš„ <code>tag</code> å±æ€§ã€‚è™½ç„¶çœ‹ä¸Šå»å¾ˆå¥‡æ€ªï¼Œä½†è¿™ç¡®å®æ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆè¦æ±‚çš„å®ç°ã€‚è¿™ä¹ˆåšçš„ç»“æœå°±æ˜¯ï¼š<strong><code>nodeOps.createElement</code> å‡½æ•°æ‰€åˆ›å»ºçš„å…ƒç´ ä¸æ¥è‡ªäºæµè§ˆå™¨çš„ DOM ç¼–ç¨‹æ¥å£ï¼Œæ›´ä¸æ¥è‡ªäºä»»ä½•å…¶ä»–å¹³å°çš„ API</strong>ï¼Œå› æ­¤ï¼Œå¦‚ä¸Šä»£ç æ‰€åˆ›å»ºçš„æ¸²æŸ“å™¨ä¹Ÿå°†æ˜¯ä¸€ä¸ªå¹³å°æ— å…³çš„æ¸²æŸ“å™¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>@vue/runtime-test</code> å¯ä»¥è¿è¡Œåœ¨ <code>NodeJs</code> ä¸­çš„åŸå› ã€‚</p> <p>å½“ç„¶äº†ï¼Œå¦‚ä¸Šä»£ç ä¸­ <code>customElement</code> åªæœ‰ä¸¤ä¸ªå±æ€§ï¼Œå®é™…ä¸Šè¿™å¹¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå³ä½¿å…ƒç´ çš„æ ¼å¼ç”±æˆ‘ä»¬è‡ªè¡Œå®šä¹‰ï¼Œä½†è¿˜æ˜¯è¦æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œä¾‹å¦‚å…ƒç´ ä¼šæœ‰å­èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹ä¹Ÿéœ€è¦ä¿å­˜å¯¹çˆ¶èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œå…ƒç´ è‡ªèº«ä¹Ÿä¼šæœ‰å±æ€§/ç‰¹æ€§ç­‰ç­‰ã€‚ä¸€ä¸ªæœ€å°ä¸”å®Œæ•´çš„å…ƒç´ å®šä¹‰åº”è¯¥åŒ…å«ä»¥ä¸‹å±æ€§ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token punctuation">,</span> <span class="token comment">// å…ƒç´ çš„ç±»å‹ï¼šELEMENT ---&gt; æ ‡ç­¾å…ƒç´ ï¼›TEXT ---&gt; æ–‡æœ¬</span>
  tag<span class="token punctuation">,</span> <span class="token comment">// å½“ type === 'ELEMENT' æ—¶ï¼Œtag å±æ€§ä¸ºæ ‡ç­¾åå­—</span>
  parentNode<span class="token punctuation">,</span> <span class="token comment">// å¯¹çˆ¶èŠ‚ç‚¹çš„å¼•ç”¨</span>
  children<span class="token punctuation">,</span> <span class="token comment">// å­èŠ‚ç‚¹</span>
  props<span class="token punctuation">,</span>  <span class="token comment">// å½“ type === 'ELEMENT' æ—¶ï¼Œprops ä¸­å­˜å‚¨ç€å…ƒç´ çš„å±æ€§/ç‰¹æ€§</span>
  eventListeners<span class="token punctuation">,</span>  <span class="token comment">// å½“ type === 'ELEMENT' æ—¶ï¼ŒeventListeners ä¸­å­˜å‚¨ç€å…ƒç´ çš„äº‹ä»¶ä¿¡æ¯</span>
  text  <span class="token comment">// å½“ type === 'TEXT' æ—¶ï¼Œtext å­˜å‚¨ç€æ–‡æœ¬å†…å®¹</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ <code>customElement</code> å°±æ˜¯ä¸€ä¸ªèƒ½å®Œå…¨ä»£æ›¿çœŸå® DOM å¯¹è±¡çš„æ¨¡æ‹Ÿå®ç°äº†ï¼Œæˆ‘ä»¬ç”¨å®ƒä¿®æ”¹ä¹‹å‰çš„ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'ELEMENT'</span><span class="token punctuation">,</span>
        tag<span class="token punctuation">,</span>
        <span class="token literal-property property">parentNode</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">eventListeners</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œç”±äº <code>nodeOps.createElement</code> å‡½æ•°ç”¨äºåˆ›å»ºå…ƒç´ èŠ‚ç‚¹ï¼Œå› æ­¤ <code>type</code> å±æ€§çš„å€¼ä¸º <code>'ELEMENT'</code>ï¼›åˆšåˆšåˆ›å»ºçš„å…ƒç´ è¿˜ä¸èƒ½ç¡®å®šå…¶çˆ¶èŠ‚ç‚¹ï¼Œå› æ­¤ <code>parentNode</code> ä¸º <code>null</code>ï¼›ç”¨äºå­˜å‚¨å­èŠ‚ç‚¹çš„ <code>children</code> å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œ<code>props</code> å±æ€§å’Œ <code>eventListeners</code> è¢«åˆå§‹åŒ–ä¸ºç©ºå¯¹è±¡ï¼›æœ€åçš„ <code>text</code> ä¸º <code>null</code>ï¼Œå› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹ã€‚</p> <p>ç°åœ¨åˆ›å»ºå…ƒç´ èŠ‚ç‚¹çš„åŠŸèƒ½å·²ç»å®ç°ï¼Œé‚£ä¹ˆåˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹å‘¢ï¼Ÿå¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span>
      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createText</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'TEXT'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">parentNode</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> text
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æ–‡æœ¬å…ƒç´ çš„ <code>type</code> ç±»å‹å€¼ä¸º <code>'TEXT'</code>ï¼Œ<code>parentNode</code> åŒæ ·è¢«åˆå§‹åŒ–ä¸º <code>unll</code>ï¼Œ<code>text</code> å±æ€§å­˜å‚¨ç€æ–‡æœ¬èŠ‚ç‚¹çš„å†…å®¹ã€‚ç”±äºæ–‡æœ¬å…ƒç´ æ²¡æœ‰å­èŠ‚ç‚¹ã€å±æ€§/ç‰¹æ€§ã€äº‹ä»¶ç­‰ä¿¡æ¯ï¼Œå› æ­¤ä¸éœ€è¦å…¶ä»–æè¿°ä¿¡æ¯ã€‚</p> <p>æ–‡æœ¬èŠ‚ç‚¹ä¸å…ƒç´ èŠ‚ç‚¹çš„åˆ›å»ºéƒ½å·²ç»å®ç°ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å½“å…ƒç´ è¢«è¿½åŠ æ—¶åº”è¯¥å¦‚ä½•å¤„ç†ï¼Œå³ <code>nodeOps.appendChild</code> å‡½æ•°çš„å®ç°ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span>
      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createText</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span>
      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ç®€å†çˆ¶å­å…³ç³»</span>
      child<span class="token punctuation">.</span>parentNode <span class="token operator">=</span> parent
      parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚ä¸Šé«˜äº®ä»£ç æ‰€ç¤ºï¼Œè¿½åŠ èŠ‚ç‚¹æ—¶æˆ‘ä»¬è¦åšçš„å°±æ˜¯å»ºç«‹èŠ‚ç‚¹é—´æ­£ç¡®çš„çˆ¶å­å…³ç³»ï¼Œåœ¨ Web å¹³å°ä¸‹ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ <code>el.appendChild</code> å‡½æ•°æ—¶ï¼Œçˆ¶å­å…³ç³»æ˜¯ç”±æµè§ˆå™¨è´Ÿè´£å»ºç«‹çš„ï¼Œä½†åœ¨æ¨¡æ‹Ÿå®ç°ä¸­ï¼Œè¿™ä¸ªå…³ç³»éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ç»´æŠ¤ã€‚ä¸è¿‡å¥½åœ¨è¿™å¾ˆç®€å•ï¼Œè®©å­å…ƒç´ çš„ <code>parentNode</code> æŒ‡å‘çˆ¶å…ƒç´ ï¼ŒåŒæ—¶å°†å­å…ƒç´ æ·»åŠ åˆ°çˆ¶å…ƒç´ çš„ <code>children</code> æ•°ç»„ä¸­å³å¯ã€‚</p> <p>ç±»ä¼¼çš„ï¼Œå¦‚ä¸‹æ˜¯ <code>nodeOps.removeChild</code> å‡½æ•°çš„å®ç°ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createText</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ç®€å†çˆ¶å­å…³ç³»</span>
      child<span class="token punctuation">.</span>parentNode <span class="token operator">=</span> parent
      parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ‰¾åˆ°å°†è¦ç§»é™¤çš„å…ƒç´  child åœ¨çˆ¶å…ƒç´ çš„ children ä¸­çš„ä½ç½®</span>
      <span class="token keyword">const</span> i <span class="token operator">=</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™å°†å…¶åˆ é™¤</span>
        parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ²¡æ‰¾åˆ°ï¼Œè¯´æ˜æ¸²æŸ“å™¨å‡ºäº†é—®é¢˜ï¼Œä¾‹å¦‚æ²¡æœ‰åœ¨ nodeOps.appendChild å‡½æ•°ä¸­ç»´æŠ¤æ­£ç¡®çš„çˆ¶å­å…³ç³»ç­‰</span>
        <span class="token comment">// è¿™æ—¶éœ€è¦æ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œä»¥æç¤ºå¼€å‘è€…</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'target: '</span><span class="token punctuation">,</span> child<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'parent: '</span><span class="token punctuation">,</span> parent<span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">'target ä¸æ˜¯ parent çš„å­èŠ‚ç‚¹'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// æ¸…ç©ºçˆ¶å­é“¾</span>
      child<span class="token punctuation">.</span>parentNode <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚ä¸Šé«˜äº®ä»£ç æ‰€ç¤ºï¼Œåœ¨ç§»é™¤èŠ‚ç‚¹æ—¶ï¼Œæ€è·¯ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆéœ€è¦åœ¨çˆ¶èŠ‚ç‚¹çš„ <code>children</code> å±æ€§ä¸­æŸ¥æ‰¾å³å°†è¦è¢«ç§»é™¤çš„èŠ‚ç‚¹çš„ä½ç½®ç´¢å¼•ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°†å…¶ä»çˆ¶èŠ‚ç‚¹çš„ <code>children</code> æ•°ç»„ä¸­ç§»é™¤å³å¯ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¯´æ˜æ¸²æŸ“å™¨å‡ºé—®é¢˜äº†ï¼Œä¾‹å¦‚åœ¨ä½ å®ç°è‡ªå®šä¹‰æ¸²æŸ“å™¨æ—¶æ²¡æœ‰åœ¨ <code>nodeOps.appendChild</code> å‡½æ•°æˆ– <code>nodeOps.insertBefore</code> å‡½æ•°ä¸­ç»´æŠ¤æ­£ç¡®çš„çˆ¶å­å…³ç³»ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦æ‰“å°é”™è¯¯ä¿¡æ¯ä»¥æç¤ºå¼€å‘è€…ã€‚æœ€åä¸è¦å¿˜è®°æ¸…ç©ºçˆ¶å­é“¾ã€‚</p> <p>é€šè¿‡å¦‚ä¸Šçš„è®²è§£ï¼Œä½ å¯èƒ½å·²ç»é¢†ä¼šåˆ°äº†ï¼Œæˆ‘ä»¬æ‰€åšçš„å…¶å®å°±æ˜¯åœ¨æ¨¡æ‹Ÿ Web å¹³å°åœ¨æ“ä½œå…ƒç´ æ—¶çš„è¡Œä¸ºï¼Œå¹¶ä¸”è¿™ä¸ªæ¨¡æ‹Ÿçš„æ€è·¯ä¹ŸåŠå…¶ç®€å•ã€‚å®é™…ä¸Šï¼Œå½“æˆ‘ä»¬å®ç°äº†æ‰€æœ‰ <code>nodeOps</code> ä¸‹çš„æŠ½è±¡å‡½æ•°ä¹‹åï¼Œé‚£ä¹ˆè¿™ä¸ªç±»ä¼¼äº <code>@vue/runtime-test</code> çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨å°±åŸºæœ¬å®Œæˆäº†ã€‚å½“ç„¶ï¼Œä¸è¦å¿˜è®°çš„æ˜¯æˆ‘ä»¬è¿˜éœ€è¦å®ç° <code>patchData</code> å‡½æ•°ï¼Œè¿™å¯èƒ½æ¯”ä½ æƒ³è±¡çš„è¦ç®€å•çš„å¤šï¼Œå¦‚ä¸‹é«˜äº®ä»£ç æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createText</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">removeChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span>
    <span class="token comment">// å…¶ä»– nodeOps å‡½æ•°çš„å®ç°</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">patchData</span><span class="token punctuation">(</span>
    <span class="token parameter">el<span class="token punctuation">,</span>
    key<span class="token punctuation">,</span>
    prevValue<span class="token punctuation">,</span>
    nextValue</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å°†å±æ€§æ·»åŠ åˆ°å…ƒç´ çš„ props å¯¹è±¡ä¸‹</span>
    el<span class="token punctuation">.</span>props<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue
    <span class="token comment">// æˆ‘ä»¬å°†å±æ€§åå­—ä¸­å‰ä¸¤ä¸ªå­—ç¬¦æ˜¯ 'o' å’Œ 'n' çš„å±æ€§è®¤ä¸ºæ˜¯äº‹ä»¶ç»‘å®š</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'o'</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'n'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¦‚æœæ˜¯äº‹ä»¶ï¼Œåˆ™å°†äº‹ä»¶æ·»åŠ åˆ°å…ƒç´ çš„ eventListeners å¯¹è±¡ä¸‹</span>
      <span class="token keyword">const</span> event <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">;</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>eventListeners <span class="token operator">||</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>eventListeners <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>event<span class="token punctuation">]</span> <span class="token operator">=</span> nextValue
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>åœ¨åˆ›å»ºæ¸²æŸ“å™¨æ—¶æˆ‘ä»¬éœ€è¦å®ç° <code>patchData</code> å‡½æ•°çš„åŠŸèƒ½ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ç”¨æ¥æ›´æ–°å…ƒç´ è‡ªèº«çš„å±æ€§/ç‰¹æ€§çš„ï¼Œåœ¨ä¹‹å‰çš„è®²è§£ä¸­æˆ‘ä»¬å®ç°äº† Web å¹³å°ä¸­ <code>patchData</code> å‡½æ•°ï¼Œç„¶è€Œåœ¨è¿™ä¸ªæ¨¡æ‹Ÿå®ç°ä¸­ï¼Œæˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±å°‘äº†å¾ˆå¤šã€‚åªéœ€è¦æŠŠå…ƒç´ çš„å±æ€§æ·»åŠ åˆ°å…ƒç´ çš„ <code>props</code> å¯¹è±¡ä¸­å³å¯ï¼ŒåŒæ—¶å¦‚æœæ˜¯äº‹ä»¶çš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿåªéœ€è¦å°†å…¶æ·»åŠ åˆ°å…ƒç´ çš„ <code>eventListeners</code> å¯¹è±¡ä¸­å°±å¯ä»¥äº†ã€‚</p> <p>å®é™…ä¸Šï¼Œæœ¬èŠ‚æˆ‘ä»¬æ‰€å®ç°çš„è‡ªå®šä¹‰æ¸²æŸ“å™¨ï¼Œå°±èƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬å¯¹ç»„ä»¶æµ‹è¯•çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥æµ‹è¯•ç»„ä»¶æ‰€æ¸²æŸ“å†…å®¹çš„æ­£ç¡®æ€§ã€‚å¦‚æœä½ æƒ³è¦è¿›ä¸€æ­¥æå‡è¯¥è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„èƒ½åŠ›ï¼Œä¾‹å¦‚å¸Œæœ›è¯¥æ¸²æŸ“å™¨æœ‰èƒ½åŠ›åœ¨æ§åˆ¶å°ä¸­æ‰“å°å‡ºæ“ä½œå…ƒç´ çš„ä¿¡æ¯ï¼Œä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬ä»¥åˆ›å»ºå…ƒç´ ä¸ºä¾‹ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> customElement <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'ELEMENT'</span><span class="token punctuation">,</span>
        tag<span class="token punctuation">,</span>
        <span class="token literal-property property">parentNode</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">eventListeners</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token keyword">null</span>
      <span class="token punctuation">}</span>

      console<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'CREATE ELEMENT'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">targetNode</span><span class="token operator">:</span> customElement
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

      <span class="token keyword">return</span> customElement
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>åªéœ€è¦åœ¨ <code>nodeOps.createElement</code> å‡½æ•°ä¸­è°ƒç”¨ <code>console.table</code> è¿›è¡Œæ‰“å°ä½ æƒ³è¦çš„ä¿¡æ¯å³å¯ï¼Œä¾‹å¦‚æˆ‘ä»¬æ‰“å°äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å« <code>type</code> å±æ€§ç”¨äºæŒ‡ç¤ºå½“å‰æ“ä½œå…ƒç´ çš„ç±»å‹ï¼Œæ‰€ä»¥å¯¹äºåˆ›å»ºå…ƒç´ æ¥è¯´ï¼Œæˆ‘ä»¬ä¸º <code>type</code> å±æ€§èµ‹å€¼äº†å­—ç¬¦ä¸² <code>'CREATE ELEMENT'</code>ï¼ŒåŒæ—¶å°†ç›®æ ‡èŠ‚ç‚¹ä¹Ÿæ‰“å°äº†å‡ºæ¥(å³ <code>targetNode</code>)ã€‚ç±»ä¼¼çš„ï¼Œè¿½åŠ èŠ‚ç‚¹å¯ä»¥æ‰“å°å¦‚ä¸‹ä¿¡æ¯ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> render <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">createRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">nodeOps</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token parameter">tag</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">/* çœç•¥... */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ç®€å†çˆ¶å­å…³ç³»</span>
      child<span class="token punctuation">.</span>parentNode <span class="token operator">=</span> parent
      parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>

      console<span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'APPEND'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">targetNode</span><span class="token operator">:</span> child<span class="token punctuation">,</span>
        <span class="token literal-property property">parentNode</span><span class="token operator">:</span> parent
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚å½“ç„¶äº†è¿™åªæ˜¯è‡ªå®šä¹‰æ¸²æŸ“å™¨çš„åº”ç”¨ä¹‹ä¸€ï¼Œå¯¹äºè‡ªå®šä¹‰æ¸²æŸ“å™¨æ¥è¯´ï¼Œå®ƒå¯å‘æŒ¥çš„ç©ºé—´è¿˜æ˜¯éå¸¸å¤§çš„ï¼Œä¸¾å‡ ä¸ªä¾‹å­ï¼š</p> <ul><li>æ¸²æŸ“åˆ° <code>PDF</code>ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªè‡ªå®šä¹‰æ¸²æŸ“å™¨å¦‚ <code>vue-pdf-renderer</code>ï¼Œå®ƒèƒ½å¤Ÿå°† <code>Vue</code> ç»„ä»¶æ¸²æŸ“ä¸º <code>PDF</code> æ–‡ä»¶ã€‚</li> <li>æ¸²æŸ“åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ª <code>vue-file-renderer</code>ï¼Œå®ƒå¯ä»¥æ ¹æ® <code>VNode</code> çš„ç»“æ„åœ¨æœ¬åœ°æ¸²æŸ“ä¸è¯¥ç»“æ„ç›¸åŒçš„æ–‡ä»¶ç›®å½•ã€‚</li> <li><code>canvas</code> æ¸²æŸ“å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ª <code>vue-canvas-renderer</code>ï¼Œå®ƒå¯ä»¥ä»æ¸²æŸ“å™¨çš„å±‚é¢æ¸²æŸ“ <code>canvas</code>ï¼Œè€Œéç»„ä»¶å±‚é¢ã€‚</li></ul> <p>ä»¥ä¸Šä»…ä»…æ˜¯ç®€å•çš„åˆ—äº†å‡ ä¸ªå°æƒ³æ³•ï¼Œå®é™…ä¸Šç”±äºè‡ªå®šä¹‰æ¸²æŸ“å™¨æœ¬èº«å°±æ˜¯å¹³å°æ— å…³çš„ï¼Œå¾ˆå¤šäº‹æƒ…éœ€è¦çœ‹ç‰¹å®šå¹³å°çš„èƒ½åŠ›ï¼Œæ¸²æŸ“å™¨ä¸ºä½ æä¾›çš„å°±æ˜¯åœ¨ç»„ä»¶å±‚é¢çš„æŠ½è±¡èƒ½åŠ›ä»¥åŠè™šæ‹Ÿ DOM çš„æ›´æ–°ç®—æ³•ï¼Œå‰©ä¸‹çš„å°±é ç¤¾åŒºçš„æƒ³è±¡åŠ›å’Œå®ç°èƒ½åŠ›äº†ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>å®Œæ•´ä»£ç &amp;åœ¨çº¿ä½“éªŒåœ°å€ï¼š<a href="https://codesandbox.io/s/v39py7lxq5" target="_blank" rel="noopener noreferrer">https://codesandbox.io/s/v39py7lxq5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <ul><li><a href="https://www.youtube.com/watch?reload=9&amp;v=cCOL7MC4Pl0&amp;feature=youtu.be" target="_blank" rel="noopener noreferrer">Jake Archibald: In The Loop - JSConf.Asia 2018<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://stackoverflow.com/questions/25915634/difference-between-microtask-and-macrotask-within-an-event-loop-context" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/25915634/difference-between-microtask-and-macrotask-within-an-event-loop-context<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://html.spec.whatwg.org/#event-loop-processing-model" target="_blank" rel="noopener noreferrer">https://html.spec.whatwg.org/#event-loop-processing-model<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/./vue3/renderer-diff.html" class="prev">
        æ¸²æŸ“å™¨çš„æ ¸å¿ƒ Diff ç®—æ³•
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="./assets/js/app.c50cae2e.js" defer></script><script src="./assets/js/4.08095b6d.js" defer></script><script src="./assets/js/82.23093c7e.js" defer></script>
  </body>
</html>
